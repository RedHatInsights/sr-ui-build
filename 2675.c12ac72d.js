/*! For license information please see 2675.c12ac72d.js.LICENSE.txt */
"use strict";(self.webpackChunk_apicurio_registry_ui=self.webpackChunk_apicurio_registry_ui||[]).push([[2675],{77685:()=>{},37799:(e,t,n)=>{n.d(t,{I:()=>E});var r,o,i=n(93264),a=n.n(i),s=n(79824),c=n(99926),l=n(99922),p=(n(45898),n(67646)),u=(n(79253),n(42557),n(30798)),d=(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),h=function(e){function t(t){var n=e.call(this,t)||this;return n.navigateBack=function(){window.history.back()},n}return d(t,e),t.prototype.render=function(){return a().createElement(a().Fragment,null,a().createElement(l.PageSection,{className:"ps_error",variant:l.PageSectionVariants.light},a().createElement("div",{className:"centerizer"},a().createElement(l.EmptyState,{variant:l.EmptyStateVariant.large},a().createElement(l.EmptyStateIcon,{icon:p.LockedIcon}),a().createElement(l.Title,{headingLevel:"h5",size:"lg"},"Access permissions needed"),a().createElement(l.EmptyStateBody,null,"To access this Service Registry instance, contact your organization administrators."),a().createElement(l.EmptyStateSecondaryActions,null,a().createElement(l.Button,{variant:"link","data-testid":"error-btn-back",onClick:this.navigateBack},"Return to previous page"))))))},t}(u.m),g=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),f=function(e){function t(t){var n=e.call(this,t)||this;return n.navigateBack=function(){window.history.back()},n}return g(t,e),t.prototype.render=function(){return a().createElement(a().Fragment,null,a().createElement(l.PageSection,{className:"ps_error",variant:l.PageSectionVariants.light},a().createElement("div",{className:"centerizer"},a().createElement(l.EmptyState,{variant:l.EmptyStateVariant.large},a().createElement(l.EmptyStateIcon,{icon:p.ExclamationCircleIcon}),a().createElement(l.Title,{headingLevel:"h5",size:"lg"},"Current usage is too high"),a().createElement(l.EmptyStateBody,null,"This Service Registry instance is throttled due to a high request rate. Ensure that existing applications are properly configured to cache the schemas."),a().createElement(l.EmptyStateSecondaryActions,null,a().createElement(l.Button,{variant:"link","data-testid":"error-btn-back",onClick:this.navigateBack},"Return to previous page"))))))},t}(u.m),m=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),y=function(){return y=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},y.apply(this,arguments)},v=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r};!function(e){e[e.React=0]="React",e[e.Server=1]="Server"}(o||(o={}));var E=function(e){function t(t){var n=e.call(this,t)||this;return setTimeout((function(){n.loadPageData()}),10),n}return m(t,e),t.prototype.initializeState=function(){return y(y({},this.initializePageState()),{isLoading:!0})},t.prototype.componentDidCatch=function(e,t){this.handleError(o.React,e,t)},t.prototype.render=function(){return this.isError()?this.is403Error()?a().createElement(h,{error:this.state.error}):this.is419Error()?a().createElement(f,{error:this.state.error}):a().createElement(s.mf,{error:this.state.error}):this.isLoading()?a().createElement(a().Fragment,null,a().createElement(l.PageSection,{variant:l.PageSectionVariants.default,isFilled:!0},a().createElement(l.Flex,null,a().createElement(l.FlexItem,null,a().createElement(l.Spinner,{size:"lg"})),a().createElement(l.FlexItem,null,a().createElement("span",null,"Loading..."))))):this.renderPage()},t.prototype.postConstruct=function(){s.Vx.setHistory(this.props.history),e.prototype.postConstruct.call(this)},t.prototype.createLoaders=function(){return null},t.prototype.handleServerError=function(e,t){this.handleError(o.Server,e,t)},t.prototype.getPathParam=function(e){var t=this.props.match.params[e];return decodeURIComponent(t)},t.prototype.isLoading=function(){return!!this.state.isLoading},t.prototype.loadPageData=function(){var e=this,t=this.createLoaders();null==t&&(t=[]),Array.isArray(t)||(t=[t]),0===(t=v([c.K9.getUsersService().updateCurrentUser()],t)).length?this.setSingleState("isLoading",!1):(this.setSingleState("isLoading",!0),Promise.all(t).then((function(){e.setSingleState("isLoading",!1)})).catch((function(t){c.K9.getLoggerService().debug("[PageComponent] Page data load failed, retrying.");var n=e.getRetries();n<1?(e.incrementRetries(),setTimeout((function(){e.loadPageData()}),100*Math.pow(2,n))):e.handleServerError(t,"Error loading page data.")})))},t.prototype.getRetries=function(){return void 0!==this.state.pageLoadRetries?this.state.pageLoadRetries:0},t.prototype.incrementRetries=function(){var e=this.getRetries()+1;this.setSingleState("pageLoadRetries",e)},t.prototype.isError=function(){return!!this.state.isError},t.prototype.is403Error=function(){return this.state.error&&this.state.error.error.status&&403==this.state.error.error.status},t.prototype.is419Error=function(){return this.state.error&&this.state.error.error.status&&419==this.state.error.error.status},t.prototype.handleError=function(e,t,n){c.K9.getLoggerService().error("[PageComponent] Handling an error of type: ",e),c.K9.getLoggerService().error("[PageComponent] ",n),c.K9.getLoggerService().error("[PageComponent] ",t),this.setMultiState({error:{error:t,errorMessage:n,type:e},isError:!0})},t}(s.Vx)},55194:(e,t,n)=>{n.d(t,{g:()=>d});var r,o=n(93264),i=n.n(o),a=n(99922),s=n(67646),c=n(79824),l=n(8556),p=n(99926),u=(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),d=function(e){function t(t){return e.call(this,t)||this}return u(t,e),t.prototype.render=function(){var e=this;return i().createElement(a.EmptyState,{variant:a.EmptyStateVariant.full},i().createElement(a.EmptyStateIcon,{icon:s.PlusCircleIcon}),i().createElement(a.Title,{headingLevel:"h5",size:"lg"},"No roles assigned"),i().createElement(l.If,{condition:function(){return!0===e.props.isFiltered}},i().createElement(a.EmptyStateBody,null,"No role mappings match your filter settings.  Change your filter or perhaps create a new role mapping.")),i().createElement(l.If,{condition:function(){return!e.props.isFiltered}},i().createElement(a.EmptyStateBody,null,this.emptyStateBodyText()),i().createElement(a.Button,{variant:"primary","data-testid":"btn-grant-access",onClick:this.props.onCreateRoleMapping},"Grant access")))},t.prototype.initializeState=function(){return{}},t.prototype.emptyStateBodyText=function(){return p.K9.getConfigService().featureMultiTenant()?"The Service Registry instance owner and organization administrators have access to resources in this instance. Grant other accounts access by assigning roles.":'There are currently no role mappings configured for the registry.  Click the "Grant access" button above to grant access to a user.'},t}(c.Vx)},95101:(e,t,n)=>{n.d(t,{C:()=>g,j:()=>d});var r,o=n(93264),i=n.n(o),a=n(99922),s=n(99926),c=n(79824),l=n(47809),p=n(67646),u=(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),d=function(e){function t(t){var n=e.call(this,t)||this;return n.onToggle=function(e){n.setSingleState("isOpen",e),n.props.onToggle(e)},n.clearSelection=function(){n.setMultiState({id:"",isOpen:!1}),n.props.onIdUpdate("")},n.onSelect=function(e,t,r){r?n.clearSelection():(n.setSingleState("id",t),n.onToggle(!1),n.props.onIdUpdate(t))},n.filter=function(e,t){var r=function(e,t){return i().createElement(a.SelectOption,{key:t,value:e.id,description:e.displayName},e.id)},o=n.props.initialOptions().filter((function(e){return"SERVICE_ACCOUNT"===e.principalType})).filter((function(e){var r;return!n.props.isUsersOnly&&(e.id.toLowerCase().includes(t.toLowerCase())||(null===(r=e.displayName)||void 0===r?void 0:r.toLowerCase().includes(t.toLowerCase())))})),s=n.props.initialOptions().filter((function(e){return"USER_ACCOUNT"===e.principalType})).filter((function(e){var n;return e.id.toLowerCase().includes(t.toLowerCase())||(null===(n=e.displayName)||void 0===n?void 0:n.toLowerCase().includes(t.toLowerCase()))})),c=[];return o.length>0&&c.push(i().createElement(a.SelectGroup,{label:"Service accounts",key:"service_accounts_group"},o.sort((function(e,t){return e.displayName&&t.displayName?e.displayName.localeCompare(t.displayName):-1})).map(r))),o.length>0&&s.length>0&&c.push(i().createElement(a.Divider,{key:"divider"})),s.length>0&&c.push(i().createElement(a.SelectGroup,{label:"User accounts",key:"user_accounts_group"},s.map(r))),c},n}return u(t,e),t.prototype.componentDidUpdate=function(e){this.props.id&&this.props.id!==e.id&&this.setSingleState("id",this.props.id)},t.prototype.initializeState=function(){return{id:"",isOpen:!1}},t.prototype.render=function(){var e=this.props,t=e.isUpdateAccess,n=e.defaultRole,r=this.filter(null,"");return i().createElement(a.Select,{variant:a.SelectVariant.typeahead,typeAheadAriaLabel:"Select an account",createText:"Use",onToggle:this.onToggle,onSelect:this.onSelect,onClear:this.clearSelection,selections:this.state.id,isOpen:this.state.isOpen,isInputValuePersisted:!0,placeholderText:t?null==n?void 0:n.principalId:"Select an account",isCreatable:!0,menuAppendTo:"parent",maxHeight:400,isGrouped:!0,onFilter:this.filter,children:r,isDisabled:t})},t}(c.Vx),h=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),g=function(e){function t(t){var n=e.call(this,t)||this;return n.closeModal=function(){var e=n.props.onClose;e&&e(),n.reset()},n.onAccountIDClearSelection=function(){n.setMultiState({accountID:"",isAccountIDSelectOpen:!1,role:void 0})},n.handlePrincipalChange=function(e){n.setMultiState({accountId:e,isValid:n.checkValid(e,n.state.role)})},n.getRoleMapping=function(){var e=n.state.accountId;e&&(n.setSingleState("isFetchingMappingRole",!0),s.K9.getAdminService().getRoleMapping(e).then((function(e){var t=e.role;n.setMultiState({role:t,isFetchingMappingRole:!1,currentRole:t})})).catch((function(e){n.setMultiState({role:l.RoleTypes.READ_ONLY,isFetchingMappingRole:!1})})))},n.onAccountIDSelect=function(e,t,r,o){if(o)n.onAccountIDClearSelection();else{var i={accountId:r,accountName:n.getAccountName(e,r),isAccountIDSelectOpen:!1};n.setMultiState(i,(function(){n.getRoleMapping()}))}},n.handleRoleChange=function(e,t){n.setMultiState({isValid:n.checkValid(n.state.accountId,t.target.value),role:t.target.value})},n.doGrantAccess=function(){var e,t={displayName:n.state.accountName,id:n.state.accountId,principalType:"USER_ACCOUNT"};n.props.onGrant(t,n.state.role,void 0!==(null===(e=n.props.roles)||void 0===e?void 0:e.find((function(e){return e.principalId==n.state.accountId})))),n.reset()},n.escapePressed=function(){n.state.escapeClosesModal&&n.closeModal()},n.onAccountSelectToggle=function(e){n.setSingleState("escapeClosesModal",!e)},n.onKey=function(e){"Enter"===e.key&&(e.stopPropagation(),e.preventDefault())},n}return h(t,e),t.prototype.componentDidMount=function(){this.setMultiState({accountId:"",accountName:"",role:void 0})},t.prototype.componentDidUpdate=function(e,t){this.props.defaultRole!==e.defaultRole&&this.props.defaultRole&&this.setMultiState({accountId:this.props.defaultRole.principalId,accountName:this.props.defaultRole.principalName,currentRole:this.props.defaultRole.role,role:this.props.defaultRole.role}),t.accountId===this.state.accountId&&t.role===this.state.role||this.setSingleState("isValid",this.checkValid(this.state.accountId,this.state.role))},t.prototype.render=function(){var e=this,t=this.state,n=t.isFetchingMappingRole,r=t.accountId,o=this.props,c=o.isUpdateAccess,u=o.defaultRole,h=s.K9.getConfigService().principals(),g="function"==typeof h?h:function(){return h||[]};return i().createElement(a.Modal,{title:"Grant access",description:this.modalDescription(),variant:"medium",isOpen:this.props.isOpen,onClose:this.closeModal,className:"grant-access-modal pf-m-redhat-font",onEscapePress:this.escapePressed,onKeyPress:this.onKey,onKeyDown:this.onKey,onKeyUp:this.onKey,actions:[i().createElement(a.Button,{key:"grant",variant:"primary","data-testid":"modal-btn-grant",onClick:this.doGrantAccess,isDisabled:!this.state.isValid||n},"Save"),i().createElement(a.Button,{key:"cancel",variant:"link","data-testid":"modal-btn-cancel",onClick:this.closeModal},"Cancel")]},i().createElement(a.Form,null,void 0!==this.props.serviceRegistryInstance?i().createElement(a.DescriptionList,null,i().createElement(a.DescriptionListGroup,null,i().createElement(a.DescriptionListTerm,null,"Service Registry instance"),i().createElement(a.DescriptionListDescription,null,this.props.serviceRegistryInstance))):void 0,i().createElement(a.FormGroup,{label:"Account",labelIcon:i().createElement(a.Popover,{"aria-label":"Account help",headerContent:i().createElement("span",null,"Account help"),bodyContent:i().createElement("div",null,"A service account enables your application or tool to connect securely to your resources. A user account enables users in your organization to access resources.")},i().createElement(p.OutlinedQuestionCircleIcon,null)),isRequired:!0,fieldId:"grant-access-account-id"},h?i().createElement(d,{id:this.state.accountId,onToggle:this.onAccountSelectToggle,onIdUpdate:function(t){e.onAccountIDSelect(g,null,t,!1)},initialOptions:g,isUpdateAccess:c,defaultRole:u}):i().createElement(a.TextInput,{isRequired:!0,type:"text",id:"grant-access-principal",name:"grant-access-principal","aria-describedby":"grant-access-principal-helper",onChange:this.handlePrincipalChange,value:r,isDisabled:c})),r&&i().createElement(a.FormGroup,{label:"Role",isRequired:!0,fieldId:"grant-access-role"},i().createElement(a.Radio,{id:"grant-access-role-admin",className:"grant-access-radio-button",name:"grant-access-role",label:this.appendString("Administrator",l.RoleTypes.ADMIN),description:"Assign roles to other accounts on this Service Registry instance, configure global rules, and access data import and export features.",value:l.RoleTypes.ADMIN,onChange:this.handleRoleChange,isChecked:this.state.role==l.RoleTypes.ADMIN,isDisabled:n}),i().createElement(a.Radio,{id:"grant-access-role-manager",className:"grant-access-radio-button",name:"grant-access-role",label:this.appendString("Manager",l.RoleTypes.DEVELOPER),description:"Read and write artifacts on this Service Registry instance.",value:l.RoleTypes.DEVELOPER,onChange:this.handleRoleChange,isChecked:this.state.role==l.RoleTypes.DEVELOPER,isDisabled:n}),i().createElement(a.Radio,{id:"grant-access-role-viewer",className:"grant-access-radio-button",name:"grant-access-role",label:this.appendString("Viewer",l.RoleTypes.READ_ONLY),description:"Read artifacts on this Service Registry instance.",value:l.RoleTypes.READ_ONLY,onChange:this.handleRoleChange,isChecked:this.state.role==l.RoleTypes.READ_ONLY,isDisabled:n}))))},t.prototype.initializeState=function(){return{accountId:"",accountName:"",currentRole:void 0,escapeClosesModal:!0,isAccountIDSelectOpen:!1,isFetchingMappingRole:!1,isValid:!1,role:void 0}},t.prototype.appendString=function(e,t){return this.state.currentRole===t?e+" (current role)":e},t.prototype.reset=function(){this.setMultiState(this.initializeState())},t.prototype.checkValid=function(e,t){return!(!e||!t)},t.prototype.getAccountName=function(e,t){var n=e();if(n)for(var r=0,o=n;r<o.length;r++){var i=o[r];if(i.id===t)return i.displayName}},t.prototype.modalDescription=function(){return s.K9.getConfigService().featureMultiTenant()?"Grant access to resources in this Service Registry instance by assigning a role to an account.":"Grant access to resources in the Registry by assigning permissions to an account"},t}(c.Vx)},51680:(e,t,n)=>{n.d(t,{s:()=>h});var r,o=n(93264),i=n.n(o),a=n(99922),s=n(28251),c=n(79824),l=n(47809),p=n(55194),u=n(99926),d=(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),h=function(e){function t(t){var n=e.call(this,t)||this;return n.onRevokeRoleMapping=function(e){n.setMultiState({isRevokeModalOpen:!0,revokingPrincipalId:e})},n.onRevokeModalClose=function(){n.setSingleState("isRevokeModalOpen",!1)},n.doRevokeAccess=function(){n.onRevokeModalClose(),n.props.onRevoke(n.state.revokingPrincipalId)},n}return d(t,e),t.prototype.render=function(){var e=this,t=function(t){return[{title:"Edit",onClick:function(){e.props.onEditRoleMapping(t)}},{title:"Remove",onClick:function(){e.onRevokeRoleMapping(t.principalId)}}]},n=this.props.roles.sort((function(e,t){return e.principalId.localeCompare(t.principalId)})).filter((function(t){var n=!1,r=!1;return e.props.roleFilter.principalId.length>0&&(r=!0,n=n||t.principalId.toLowerCase().includes(e.props.roleFilter.principalId.toLowerCase())),e.props.roleFilter.principalName.length>0&&(r=!0,n=n||t.principalName.toLowerCase().includes(e.props.roleFilter.principalName.toLowerCase())),!r||n})).filter((function(t){if(e.props.roleFilter.role.length>0)switch(t.role){case l.RoleTypes.DEVELOPER:return"Manager"==e.props.roleFilter.role;case l.RoleTypes.ADMIN:return"Administrator"==e.props.roleFilter.role;case l.RoleTypes.READ_ONLY:return"Viewer"==e.props.roleFilter.role}return!0}));return 0===n.length?i().createElement(p.g,{isFiltered:!0}):i().createElement(i().Fragment,null,i().createElement(s.TableComposable,{className:"role-list"},i().createElement(s.Thead,null,i().createElement(s.Tr,null,i().createElement(s.Th,null,"Account"),i().createElement(s.Th,null,"Role"))),i().createElement(s.Tbody,null,n.map((function(n,r){return i().createElement(s.Tr,{key:r},i().createElement(s.Td,null,i().createElement("div",{className:"principal-id"},n.principalId),i().createElement("div",{className:"principal-name"},n.principalName)),i().createElement(s.Td,null,e.roleName(n.role)),i().createElement(s.Td,{className:"role-list-action-column",key:r+"_2",actions:{items:t(n)}}))})))),i().createElement(a.Modal,{title:"Remove role?",variant:"small",isOpen:this.state.isRevokeModalOpen,onClose:this.onRevokeModalClose,className:"revoke-access-modal pf-m-redhat-font",actions:[i().createElement(a.Button,{key:"revoke",variant:"primary","data-testid":"modal-btn-revoke",onClick:this.doRevokeAccess},"Remove"),i().createElement(a.Button,{key:"cancel",variant:"link","data-testid":"modal-btn-cancel",onClick:this.onRevokeModalClose},"Cancel")]},i().createElement("p",null,this.removeRoleConfirmModalBodyText())))},t.prototype.initializeState=function(){return{isRevokeModalOpen:!1,revokingPrincipalId:"",currentRole:this.props.roles[0]}},t.prototype.roleName=function(e){switch(e){case l.RoleTypes.DEVELOPER:return"Manager";case l.RoleTypes.ADMIN:return"Administrator";case l.RoleTypes.READ_ONLY:return"Viewer"}return e},t.prototype.removeRoleConfirmModalBodyText=function(){return u.K9.getConfigService().featureMultiTenant()?"Do you really want to revoke "+this.state.revokingPrincipalId+"'s access?":this.state.revokingPrincipalId+" will no longer have access to this Service Registry instance."},t}(c.Vx)}}]);
//# sourceMappingURL=2675.c12ac72d.js.map