/*! For license information please see 60.bundle.c40b91d6f04af9eba1e3.js.LICENSE.txt */
"use strict";(self.webpackChunk_apicurio_registry_ui=self.webpackChunk_apicurio_registry_ui||[]).push([[60],{19595:(e,t,n)=>{n.d(t,{g:()=>u});var i,r=n(48121),o=n.n(r),a=n(95995),l=n(93568),c=n(60553),s=n(24754),p=(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},i(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),u=function(e){function t(t){return e.call(this,t)||this}return p(t,e),t.prototype.render=function(){var e=this;return o().createElement(a.EmptyState,{variant:a.EmptyStateVariant.full},o().createElement(a.EmptyStateIcon,{icon:l.PlusCircleIcon}),o().createElement(a.Title,{headingLevel:"h5",size:"lg"},"No Role Mappings"),o().createElement(s.If,{condition:function(){return!0===e.props.isFiltered}},o().createElement(a.EmptyStateBody,null,"No role mappings match your filter settings.  Change your filter or perhaps create a new role mapping.")),o().createElement(s.If,{condition:function(){return!e.props.isFiltered}},o().createElement(a.EmptyStateBody,null,'There are currently no role mappings configured for the registry.  Click the "Grant Access" button above to grant access to a user.'),o().createElement(a.Button,{variant:"primary","data-testid":"btn-grant-access",onClick:this.props.onCreateRoleMapping},"Grant Access")))},t.prototype.initializeState=function(){return{}},t}(c.Vx)},38166:(e,t,n)=>{n.d(t,{C:()=>f});var i,r=n(48121),o=n.n(r),a=n(95995),l=n(46768),c=n(60553),s=n(19162),p=n(93568),u=(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},i(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),d=function(e){function t(t){var n=e.call(this,t)||this;return n.onToggle=function(e){n.setSingleState("isOpen",e)},n.clearSelection=function(){n.reset()},n.onSelect=function(e,t,i){i?n.clearSelection():n.setMultiState({id:t,isOpen:!1}),n.props.onIdUpdate(t)},n}return u(t,e),t.prototype.initializeState=function(){return{id:"",isOpen:!1}},t.prototype.reset=function(){this.setMultiState(this.initializeState())},t.prototype.render=function(){var e=this.props,t=e.initialOptions,n=e.id;return o().createElement(a.Select,{variant:a.SelectVariant.typeahead,typeAheadAriaLabel:"Select an account",onToggle:this.onToggle,onSelect:this.onSelect,onClear:this.clearSelection,selections:n,isOpen:this.state.isOpen,isInputValuePersisted:!0,placeholderText:"Select an account",isCreatable:!1,maxHeight:400,isGrouped:!0},[o().createElement(a.SelectGroup,{label:"Service accounts",key:"service_accounts_group"},t.filter((function(e){return"SERVICE_ACCOUNT"===e.principalType})).map((function(e,t){return o().createElement(a.SelectOption,{key:t,value:e.id,description:e.displayName},e.id)}))),o().createElement(a.Divider,{key:"divider"}),o().createElement(a.SelectGroup,{label:"User accounts",key:"user_accounts_group"},t.filter((function(e){return"USER_ACCOUNT"===e.principalType})).map((function(e,t){return o().createElement(a.SelectOption,{key:t,value:e.id,description:e.displayName},e.id)})))])},t}(c.Vx),h=n(25108),g=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),f=function(e){function t(t){var n=e.call(this,t)||this;return n.onAccountIDClearSelection=function(){n.setMultiState({accountID:"",isAccountIDSelectOpen:!1})},n.handlePrincipalChange=function(e){n.setMultiState({accountId:e,isValid:n.checkValid(e,n.state.role)})},n.onAccountIDSelect=function(e,t,i){i?n.onAccountIDClearSelection():(n.setMultiState({accountId:t,isValid:n.checkValid(t,n.state.role),isAccountIDSelectOpen:!1}),h.log("selected:",t))},n.onAccountIDToggle=function(e){n.setSingleState("isAccountIDSelectOpen",e)},n.handleRoleChange=function(e,t){n.setMultiState({role:t.target.value,isValid:n.checkValid(n.state.accountId,t.target.value)})},n.doGrantAccess=function(){var e;n.props.onGrant(n.state.accountId,n.state.role,void 0!==(null===(e=n.props.roles)||void 0===e?void 0:e.find((function(e){return e.principalId==n.state.accountId})))),n.reset()},n}return g(t,e),t.prototype.componentDidUpdate=function(e){this.props.defaultRole!==e.defaultRole&&(this.props.defaultRole?this.setMultiState({accountId:this.props.defaultRole.principalId,role:this.props.defaultRole.role}):this.setMultiState({accountId:"",role:void 0}))},t.prototype.render=function(){var e,t=this,n=l.Services.getConfigService().principals();return o().createElement(a.Modal,{title:"Manage Permissions",description:"Manage access to resources in this Service Registry instance by assigning permissions to an account.",variant:"medium",isOpen:this.props.isOpen,onClose:this.props.onClose,className:"grant-access-modal pf-m-redhat-font",actions:[o().createElement(a.Button,{key:"grant",variant:"primary","data-testid":"modal-btn-grant",onClick:this.doGrantAccess,isDisabled:!this.state.isValid},this.props.isUpdateAccess?"Update":"Create"),o().createElement(a.Button,{key:"cancel",variant:"link","data-testid":"modal-btn-cancel",onClick:this.props.onClose},"Cancel")]},o().createElement(a.Form,null,void 0!==this.props.serviceRegistryInstance?o().createElement(a.DescriptionList,null,o().createElement(a.DescriptionListGroup,null,o().createElement(a.DescriptionListTerm,null,"Service Registry instance"),o().createElement(a.DescriptionListDescription,null,this.props.serviceRegistryInstance))):void 0,o().createElement(a.FormGroup,{label:"Account ID",labelIcon:o().createElement(a.Tooltip,{position:"top",content:o().createElement("div",null,"A service account enables your application or tool to connect securely to your resources. A user account enables users in your organization to access resources.")},o().createElement(p.OutlinedQuestionCircleIcon,null)),isRequired:!0,fieldId:"grant-access-account-id"},n?o().createElement(d,{id:this.state.accountId,onIdUpdate:function(e){t.setMultiState({accountId:e,isValid:t.checkValid(e,t.state.role),isAccountIDSelectOpen:!1})},initialOptions:n||[]}):null!==this.props.roles?o().createElement(a.Select,{id:"grant-access-principal",name:"grant-access-principal",variant:a.SelectVariant.typeahead,typeAheadAriaLabel:"Select an account ID",onToggle:this.onAccountIDToggle,onSelect:this.onAccountIDSelect,onClear:this.onAccountIDClearSelection,selections:this.state.accountId,isOpen:this.state.isAccountIDSelectOpen,isInputValuePersisted:!0,placeholderText:this.props.isUpdateAccess?null===(e=this.props.defaultRole)||void 0===e?void 0:e.principalId:"Select an account ID",maxHeight:"100px",isDisabled:this.props.isUpdateAccess},this.props.roles.map((function(e,t){return o().createElement(a.SelectOption,{key:t,value:e.principalId})}))):o().createElement(a.TextInput,{isRequired:!0,type:"text",id:"grant-access-principal",name:"grant-access-principal","aria-describedby":"grant-access-principal-helper",onChange:this.handlePrincipalChange})),o().createElement(a.FormGroup,{label:"Role",isRequired:!0,fieldId:"grant-access-role"},o().createElement(a.Radio,{id:"grant-access-role-admin",className:"grant-access-radio-button",name:"grant-access-role",label:"Administrator",description:"Give roles to other principals on this Service Registry instance, configure global rules, and access data import and export features.",value:s.RoleTypes.ADMIN,onChange:this.handleRoleChange,isChecked:this.state.role==s.RoleTypes.ADMIN}),o().createElement(a.Radio,{id:"grant-access-role-manager",className:"grant-access-radio-button",name:"grant-access-role",label:"Manager",description:"Read and write artifacts on this Service Registry instance.",value:s.RoleTypes.DEVELOPER,onChange:this.handleRoleChange,isChecked:this.state.role==s.RoleTypes.DEVELOPER}),o().createElement(a.Radio,{id:"grant-access-role-viewer",className:"grant-access-radio-button",name:"grant-access-role",label:"Viewer",description:"Read artifacts on this Service Registry instance.",value:s.RoleTypes.READ_ONLY,onChange:this.handleRoleChange,isChecked:this.state.role==s.RoleTypes.READ_ONLY}))))},t.prototype.initializeState=function(){return{isAccountIDSelectOpen:!1,isValid:!1,accountId:this.props.isUpdateAccess&&this.props.roles?this.props.roles[0].principalId:"",role:void 0}},t.prototype.reset=function(){this.setMultiState(this.initializeState())},t.prototype.checkValid=function(e,t){return!!e&&!!t},t}(c.Vx)},41016:(e,t,n)=>{n.d(t,{s:()=>d});var i,r=n(48121),o=n.n(r),a=n(95995),l=n(34168),c=n(60553),s=n(19162),p=n(19595),u=(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},i(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),d=function(e){function t(t){var n=e.call(this,t)||this;return n.onRevokeRoleMapping=function(e){n.setMultiState({isRevokeModalOpen:!0,revokingPrincipalId:e})},n.onRevokeModalClose=function(){n.setSingleState("isRevokeModalOpen",!1)},n.doRevokeAccess=function(){n.onRevokeModalClose(),n.props.onRevoke(n.state.revokingPrincipalId)},n}return u(t,e),t.prototype.render=function(){var e=this,t=function(t){return[{title:"Edit",onClick:function(){e.props.onEditRoleMapping(t)}},{title:"Revoke Access",onClick:function(){e.onRevokeRoleMapping(t.principalId)}}]},n=this.props.roles.sort((function(e,t){return e.principalId.localeCompare(t.principalId)})).filter((function(t){return!(e.props.roleFilter.principalId.length>0)||t.principalId.includes(e.props.roleFilter.principalId)})).filter((function(t){if(e.props.roleFilter.role.length>0)switch(t.role){case s.RoleTypes.DEVELOPER:return"Manager".includes(e.props.roleFilter.role);case s.RoleTypes.ADMIN:return"Admin".includes(e.props.roleFilter.role);case s.RoleTypes.READ_ONLY:return"Viewer".includes(e.props.roleFilter.role)}return!0}));return 0===n.length?o().createElement(p.g,{isFiltered:!0}):o().createElement(o().Fragment,null,o().createElement(l.TableComposable,null,o().createElement(l.Thead,null,o().createElement(l.Tr,null,o().createElement(l.Th,null,"Account"),o().createElement(l.Th,null,"Role"))),o().createElement(l.Tbody,null,n.map((function(n,i){return o().createElement(l.Tr,{key:i},o().createElement(l.Td,null,n.principalId),o().createElement(l.Td,null,e.roleName(n.role)),o().createElement(l.Td,{className:"role-list-action-column",key:i+"_2",actions:{items:t(n)}}))})))),o().createElement(a.Modal,{title:"Revoke Access",variant:"small",isOpen:this.state.isRevokeModalOpen,onClose:this.onRevokeModalClose,className:"revoke-access-modal pf-m-redhat-font",actions:[o().createElement(a.Button,{key:"revoke",variant:"primary","data-testid":"modal-btn-revoke",onClick:this.doRevokeAccess},"Revoke"),o().createElement(a.Button,{key:"cancel",variant:"link","data-testid":"modal-btn-cancel",onClick:this.onRevokeModalClose},"Cancel")]},o().createElement("p",null,"Do you really want to revoke ",this.state.revokingPrincipalId,"'s access?")))},t.prototype.initializeState=function(){return{isRevokeModalOpen:!1,revokingPrincipalId:"",currentRole:this.props.roles[0]}},t.prototype.roleName=function(e){switch(e){case s.RoleTypes.DEVELOPER:return"Manager";case s.RoleTypes.ADMIN:return"Admin";case s.RoleTypes.READ_ONLY:return"Viewer"}return e},t}(c.Vx)},54896:(e,t,n)=>{n.d(t,{s:()=>m});var i,r=n(48121),o=n.n(r),a=n(95995),l=n(93568),c=n(26619),s=n(46768),p=n(11940),u=n(60553),d=n(25108),h=(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},i(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),g=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),r=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,l=o.length;a<l;a++,r++)i[r]=o[a];return i},f=["Account","Role"],m=function(e){function t(t){var n=e.call(this,t)||this;return n.onRoleFilterToggle=function(e){n.setSingleState("roleListFilterOpened",e)},n.onRoleFilterSelect=function(e,t,i){n.setMultiState({roleFilterSelected:t,roleListFilterOpened:!1})},n.onRoleFilterInputChange=function(e){n.setSingleState("roleFilterTextInputValue",e)},n.onRoleFilterApplyClick=function(){var e,t={principalId:n.state.roleFilterSelected==f[0]?n.state.roleFilterTextInputValue:null===(e=n.state.roleFilter)||void 0===e?void 0:e.principalId,role:n.state.roleFilterSelected==f[1]?n.state.roleFilterTextInputValue:n.state.roleFilter.role};n.setSingleState("roleFilter",t)},n.onCreateRoleMapping=function(){n.setSingleState("isCreateRoleMappingModalOpen",!0)},n.closeRoleMappingModal=function(){n.setMultiState({selectedRole:void 0,isRoleMappingUpdate:!1,isCreateRoleMappingModalOpen:!1})},n.onEditRoleMapping=function(e){n.setMultiState({selectedRole:e,isRoleMappingUpdate:!0}),n.onCreateRoleMapping()},n.onUpdateRoleMapping=function(e,t){n.pleaseWait(!0,"Granting access, please wait..."),s.Services.getAdminService().updateRoleMapping(e,t).then((function(e){var t=n.state.roles;t.map((function(n,i){n.principalId==e.principalId&&(t[i]=e,d.log("found role"))})),n.pleaseWait(!1,""),n.setSingleState("roles",g(t))})).catch((function(e){return n.handleServerError(e,"Error updating access.")}))},n.createRoleMapping=function(e,t,i){n.closeRoleMappingModal(),i?n.onUpdateRoleMapping(e,t):(n.pleaseWait(!0,"Granting access, please wait..."),s.Services.getAdminService().createRoleMapping(e,t).then((function(e){n.pleaseWait(!1,""),n.setSingleState("roles",g([e],n.state.roles))})).catch((function(e){return n.handleServerError(e,"Error granting access.")})))},n.onRevokeRoleMapping=function(e){n.pleaseWait(!0,"Revoking access for "+e+", please wait..."),s.Services.getAdminService().deleteRoleMapping(e).then((function(){n.pleaseWait(!1,""),n.removeMapping(e)})).catch((function(e){return n.handleServerError(e,"Error revoking access.")}))},n.pleaseWait=function(e,t){n.setMultiState({isPleaseWaitModalOpen:e,pleaseWaitMessage:t})},n}return h(t,e),t.prototype.renderPage=function(){var e=this;return o().createElement(o().Fragment,null,o().createElement(a.PageSection,{className:"ps_roles-header",variant:a.PageSectionVariants.light,padding:{default:"noPadding"}},o().createElement(u.N4,{tabKey:2})),o().createElement(a.PageSection,{variant:a.PageSectionVariants.default,isFilled:!0,className:"ps_role-section"},0===this.state.roles.length?o().createElement(p.gx,{onCreateRoleMapping:this.onCreateRoleMapping}):o().createElement(o().Fragment,null,o().createElement(a.Toolbar,{id:"toolbar",clearAllFilters:function(){e.setSingleState("roleFilter",{principalId:"",role:""})}},o().createElement(a.ToolbarContent,null,o().createElement(a.ToolbarGroup,null,o().createElement(a.ToolbarItem,{className:"ps_role-filter-select-toolbar-item"},o().createElement(a.Select,{variant:a.SelectVariant.single,"aria-label":"Filter On",onToggle:this.onRoleFilterToggle,onSelect:this.onRoleFilterSelect,selections:this.state.roleFilterSelected,isOpen:this.state.roleListFilterOpened},f.map((function(e,t){return o().createElement(a.SelectOption,{key:t,value:e})})))),o().createElement(a.ToolbarItem,null,o().createElement(a.InputGroup,null,o().createElement(a.TextInput,{value:this.state.roleFilterTextInputValue,name:"roleFilterInput",id:"roleFilterInput",type:"search","aria-label":"role filter input",onChange:this.onRoleFilterInputChange}),o().createElement(a.Button,{variant:a.ButtonVariant.control,"aria-label":"search button for search input",onClick:this.onRoleFilterApplyClick},o().createElement(l.SearchIcon,null)))),o().createElement(a.ToolbarItem,null,o().createElement(a.Button,{variant:"primary","data-testid":"btn-grant-access",onClick:this.onCreateRoleMapping},"Grant Access")),o().createElement(a.ToolbarFilter,{chips:this.state.roleFilter.principalId.length>0?[this.state.roleFilter.principalId]:void 0,deleteChip:function(){e.setSingleState("roleFilter",{principalId:"",role:e.state.roleFilter.role})},categoryName:"Account"}," "),o().createElement(a.ToolbarFilter,{chips:this.state.roleFilter.role.length>0?[this.state.roleFilter.role]:void 0,deleteChip:function(){e.setSingleState("roleFilter",{principalId:e.state.roleFilter.principalId,role:""})},categoryName:"Role"}," ")))),o().createElement(p.st,{roles:this.state.roles,roleFilter:this.state.roleFilter,onRevoke:this.onRevokeRoleMapping,onEditRoleMapping:this.onEditRoleMapping}))),o().createElement(p.C0,{isOpen:this.state.isCreateRoleMappingModalOpen,isUpdateAccess:this.state.isRoleMappingUpdate,onClose:this.closeRoleMappingModal,onGrant:this.createRoleMapping,roles:this.state.isRoleMappingUpdate?this.state.roles:null,defaultRole:this.state.selectedRole}),o().createElement(u.jb,{message:this.state.pleaseWaitMessage,isOpen:this.state.isPleaseWaitModalOpen}))},t.prototype.initializePageState=function(){return{isCreateRoleMappingModalOpen:!1,isPleaseWaitModalOpen:!1,isRoleMappingUpdate:!1,pleaseWaitMessage:"",isLoading:!0,selectedRole:void 0,roles:[],roleFilter:{principalId:"",role:""},roleListFilterOpened:!1,roleFilterSelected:f[0],roleFilterTextInputValue:""}},t.prototype.createLoaders=function(){var e=this;return s.Services.getAdminService().getRoleMappings().then((function(t){e.setMultiState({isLoading:!1,roles:t})}))},t.prototype.removeMapping=function(e){var t=this.state.roles.filter((function(t){return t.principalId!==e}));this.setSingleState("roles",t)},t}(c.I)}}]);
//# sourceMappingURL=60.bundle.c40b91d6f04af9eba1e3.js.map