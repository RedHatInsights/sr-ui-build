{"version":3,"file":"60.bundle.154ff5932bca7d7b6d88.js","mappings":"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","sources":["webpack://@apicurio/registry-ui/./src/app/pages/roles/components/empty/empty.tsx","webpack://@apicurio/registry-ui/./src/app/pages/roles/components/modals/selectPrincipalAccount.tsx","webpack://@apicurio/registry-ui/./src/app/pages/roles/components/modals/grantAccessModal.tsx","webpack://@apicurio/registry-ui/./src/app/pages/roles/components/roleList/roleList.tsx","webpack://@apicurio/registry-ui/./src/app/pages/roles/roles.tsx"],"sourcesContent":["/**\n * @license\n * Copyright 2020 JBoss Inc\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport React from \"react\";\nimport {Button, EmptyState, EmptyStateBody, EmptyStateIcon, EmptyStateVariant, Title} from '@patternfly/react-core';\nimport {PlusCircleIcon} from \"@patternfly/react-icons\";\nimport {PureComponent, PureComponentProps, PureComponentState} from \"../../../../components\";\nimport {If} from \"../../../../components/common/if\";\n\n/**\n * Properties\n */\nexport interface RoleMappingsEmptyStateProps extends PureComponentProps {\n    isFiltered?: boolean;\n    onCreateRoleMapping?: ()=>void;\n}\n\n/**\n * State\n */\n// tslint:disable-next-line:no-empty-interface\nexport interface RoleMappingsEmptyStateState extends PureComponentState {\n}\n\n\n/**\n * Models the empty state for the Artifacts page (when there are no artifacts).\n */\nexport class RoleMappingsEmptyState extends PureComponent<RoleMappingsEmptyStateProps, RoleMappingsEmptyStateState> {\n\n    constructor(props: Readonly<RoleMappingsEmptyStateProps>) {\n        super(props);\n    }\n\n    public render(): React.ReactElement {\n        return (\n            <EmptyState variant={EmptyStateVariant.full}>\n                <EmptyStateIcon icon={PlusCircleIcon}/>\n                <Title headingLevel=\"h5\" size=\"lg\">\n                    No Role Mappings\n                </Title>\n                <If condition={() => this.props.isFiltered === true}>\n                    <EmptyStateBody>\n                        No role mappings match your filter settings.  Change your filter or perhaps create a new\n                        role mapping.\n                    </EmptyStateBody>\n                </If>\n                <If condition={() => !this.props.isFiltered}>\n                    <EmptyStateBody>\n                        There are currently no role mappings configured for the registry.  Click the \"Grant Access\"\n                        button above to grant access to a user.\n                    </EmptyStateBody>\n                    <Button variant=\"primary\" data-testid=\"btn-grant-access\" onClick={this.props.onCreateRoleMapping}>Grant Access</Button>\n                </If>\n            </EmptyState>\n        );\n    }\n\n    protected initializeState(): RoleMappingsEmptyStateState {\n        return {};\n    }\n\n}\n","/**\n * @license\n * Copyright 2021 Red Hat\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport {Divider, Select, SelectGroup, SelectOption, SelectVariant,} from '@patternfly/react-core';\nimport {PureComponent, PureComponentProps, PureComponentState} from \"../../../../components\";\nimport {Principal} from '../../../../../services/config';\n\nexport interface SelectPrincipalAccountProps extends PureComponentProps{\n  id: string | undefined;\n  onIdUpdate: (id: string) => void;\n  initialOptions: Principal[];\n}\n\nexport interface SelectPrincipalAccountState extends PureComponentState{\n  id: string | undefined;\n  isOpen: boolean;\n}\n\nexport class SelectPrincipalAccount extends PureComponent<SelectPrincipalAccountProps, SelectPrincipalAccountState> {\n\n  constructor(props: Readonly<SelectPrincipalAccountProps>) {\n    super(props);\n}\n    private onToggle = (isOpen: boolean) => {\n      this.setSingleState(\"isOpen\", isOpen);\n    };\n\n    private clearSelection = () => {\n      this.reset();\n    };\n\n    private onSelect = (_event:any, selection:any, isPlaceholder:any) => {\n      if (isPlaceholder) {\n        this.clearSelection();\n      } else {\n        this.setMultiState({\n          id: selection,\n          isOpen: false\n        })\n      }\n      this.props.onIdUpdate(selection);\n    };\n\n  protected initializeState(): SelectPrincipalAccountState {\n    return {\n      id: \"\",\n      isOpen: false\n    };\n  }\n\n  public reset(): void {\n    this.setMultiState(this.initializeState());\n  }\n\n  public render(): React.ReactElement {\n    const { initialOptions,\n      id\n    } = this.props;\n\n    return (\n      <Select\n        variant={SelectVariant.typeahead}\n        typeAheadAriaLabel={\"Select an account\"}\n        onToggle={this.onToggle}\n        onSelect={this.onSelect}\n        onClear={this.clearSelection}\n        selections={id}\n        isOpen={this.state.isOpen}\n        isInputValuePersisted={true}\n        placeholderText={\"Select an account\"}\n        isCreatable={false}\n        maxHeight={400}\n        isGrouped={true}\n      >\n        {[\n          <SelectGroup\n            label={\"Service accounts\"}\n            key='service_accounts_group'\n          >\n            {\n            initialOptions\n              .filter(\n                (principal) =>\n                  principal.principalType === \"SERVICE_ACCOUNT\"\n              )\n              .map((principal, index) => (\n                <SelectOption\n                  key={index}\n                  value={principal.id}\n                  description={principal.displayName}\n                >\n                  {principal.id}\n                </SelectOption>\n              ))}\n          </SelectGroup>,\n          <Divider key='divider' />,\n          <SelectGroup\n            label={\"User accounts\"}\n            key='user_accounts_group'\n          >\n            {initialOptions\n              .filter(\n                (principal) =>\n                  principal.principalType === \"USER_ACCOUNT\"\n              )\n              .map((principal, index) => (\n                <SelectOption\n                  key={index}\n                  value={principal.id}\n                  description={principal.displayName}\n                >\n                  {principal.id}\n                </SelectOption>\n              ))}\n          </SelectGroup>,\n        ]}\n      </Select>\n    );\n  };\n}\n","/**\n * @license\n * Copyright 2021 Red Hat\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport React from \"react\";\nimport {\n    Button,\n    DescriptionList,\n    DescriptionListDescription,\n    DescriptionListGroup,\n    DescriptionListTerm,\n    Form,\n    FormGroup,\n    Modal,\n    Radio,\n    Select,\n    SelectOption,\n    SelectOptionObject,\n    SelectVariant,\n    TextInput,\n    Tooltip\n} from '@patternfly/react-core';\nimport {Principal, Services} from \"../../../../../services\";\nimport {PureComponent, PureComponentProps, PureComponentState} from \"../../../../components\";\nimport {RoleMapping, RoleTypes} from \"../../../../../models\";\nimport {OutlinedQuestionCircleIcon} from '@patternfly/react-icons'\nimport {SelectPrincipalAccount} from \"./selectPrincipalAccount\";\nimport \"./grantAccessModal.css\";\n\n/**\n * Properties\n */\nexport interface GrantAccessModalProps extends PureComponentProps {\n    isOpen: boolean;\n    isUpdateAccess: boolean;\n    serviceRegistryInstance?: string;\n    accountId?: string;\n    roles: null | RoleMapping[];\n    defaultRole?: RoleMapping;\n    onClose: () => void;\n    onGrant: (principal: Principal, role: string, isUpdate: boolean) => void;\n}\n\n/**\n * State\n */\n// tslint:disable-next-line:no-empty-interface\nexport interface GrantAccessModalState extends PureComponentState {\n    isAccountIDSelectOpen: boolean;\n    isValid: boolean;\n    accountId: string | undefined;\n    accountName: string | undefined;\n    role: string | undefined;\n}\n\n\n/**\n * Models the modal dialog for granting access to a user.\n */\nexport class GrantAccessModal extends PureComponent<GrantAccessModalProps, GrantAccessModalState> {\n\n    constructor(props: Readonly<GrantAccessModalProps>) {\n        super(props);\n    }\n    componentDidUpdate(prevProps: GrantAccessModalProps) {\n        if (this.props.defaultRole !== prevProps.defaultRole) {\n            if (this.props.defaultRole) {\n                this.setMultiState({\n                    accountId: this.props.defaultRole.principalId,\n                    accountName: this.props.defaultRole.principalName,\n                    role: this.props.defaultRole.role\n                });\n            } else {\n                this.setMultiState({\n                    accountId: \"\",\n                    accountName: \"\",\n                    role: undefined\n                });\n            }\n        }\n    }\n\n    public render(): React.ReactElement {\n        const principals: Principal[] | undefined = Services.getConfigService().principals();\n\n        return (\n            <Modal\n                title=\"Manage Permissions\"\n                description=\"Manage access to resources in this Service Registry instance by assigning permissions to an account.\"\n                variant=\"medium\"\n                isOpen={this.props.isOpen}\n                onClose={this.props.onClose}\n                className=\"grant-access-modal pf-m-redhat-font\"\n                actions={[\n                    <Button key=\"grant\" variant=\"primary\" data-testid=\"modal-btn-grant\" onClick={this.doGrantAccess} isDisabled={!this.state.isValid}>{this.props.isUpdateAccess ? \"Update\" : \"Create\"}</Button>,\n                    <Button key=\"cancel\" variant=\"link\" data-testid=\"modal-btn-cancel\" onClick={this.props.onClose}>Cancel</Button>\n                ]}\n            >\n                <Form>\n                    {this.props.serviceRegistryInstance !== undefined ? (<DescriptionList>\n                        <DescriptionListGroup>\n                            <DescriptionListTerm>Service Registry instance</DescriptionListTerm>\n                            <DescriptionListDescription>{this.props.serviceRegistryInstance}</DescriptionListDescription>\n                        </DescriptionListGroup>\n                    </DescriptionList>\n                    ) : undefined}\n\n                    <FormGroup\n                        label=\"Account ID\"\n                        labelIcon={<Tooltip\n                            position=\"top\"\n                            content={\n                              <div>A service account enables your application or tool to connect securely to your resources. A user account enables users in your organization to access resources.</div>\n                            }\n                          >\n                            <OutlinedQuestionCircleIcon/>\n                          </Tooltip>}\n                        isRequired\n                        fieldId=\"grant-access-account-id\"\n                    >\n                        {principals ? <SelectPrincipalAccount\n                            id={this.state.accountId}\n                            onIdUpdate={(id: string) => {\n                                this.onAccountIDSelect(null, id, false);\n                            }}\n                            initialOptions={principals? principals: []}/> :\n                            this.props.roles !== null ?\n                            <Select\n                                id=\"grant-access-principal\"\n                                name=\"grant-access-principal\"\n                                variant={SelectVariant.typeahead}\n                                typeAheadAriaLabel=\"Select an account ID\"\n                                onToggle={this.onAccountIDToggle}\n                                onSelect={this.onAccountIDSelect}\n                                onClear={this.onAccountIDClearSelection}\n                                selections={this.state.accountId}\n                                isOpen={this.state.isAccountIDSelectOpen}\n                                isInputValuePersisted={true}\n                                placeholderText={this.props.isUpdateAccess ? this.props.defaultRole?.principalId : \"Select an account ID\"}\n                                maxHeight = {'100px'}\n                                isDisabled={this.props.isUpdateAccess}\n                            >\n                                {this.props.roles.map((option, index) => (\n                                    <SelectOption\n                                        key={index}\n                                        value={option.principalId}\n\n                                    />\n                                ))}\n                            </Select> :\n                            <TextInput\n                                isRequired\n                                type=\"text\"\n                                id=\"grant-access-principal\"\n                                name=\"grant-access-principal\"\n                                aria-describedby=\"grant-access-principal-helper\"\n                                onChange={this.handlePrincipalChange}\n                            />\n                        }\n                    </FormGroup>\n                    <FormGroup\n                        label=\"Role\"\n                        isRequired\n                        fieldId=\"grant-access-role\"\n                    >\n                        <Radio id=\"grant-access-role-admin\"\n                            className=\"grant-access-radio-button\"\n                            name=\"grant-access-role\"\n                            label=\"Administrator\"\n                            description=\"Give roles to other principals on this Service Registry instance, configure global rules, and access data import and export features.\"\n                            value={RoleTypes.ADMIN}\n                            onChange={this.handleRoleChange}\n                            isChecked={this.state.role == RoleTypes.ADMIN}\n                        />\n\n                        <Radio id=\"grant-access-role-manager\"\n                            className=\"grant-access-radio-button\"\n                            name=\"grant-access-role\"\n                            label=\"Manager\"\n                            description=\"Read and write artifacts on this Service Registry instance.\"\n                            value={RoleTypes.DEVELOPER}\n                            onChange={this.handleRoleChange}\n                            isChecked={this.state.role == RoleTypes.DEVELOPER} />\n\n                        <Radio id=\"grant-access-role-viewer\"\n                            className=\"grant-access-radio-button\"\n                            name=\"grant-access-role\"\n                            label=\"Viewer\"\n                            description=\"Read artifacts on this Service Registry instance.\"\n                            value={RoleTypes.READ_ONLY}\n                            onChange={this.handleRoleChange}\n                            isChecked={this.state.role == RoleTypes.READ_ONLY}/>\n                    </FormGroup>\n                </Form>\n\n            </Modal>\n        );\n    }\n\n    protected initializeState(): GrantAccessModalState {\n        return {\n            isAccountIDSelectOpen: false,\n            isValid: false,\n            accountId: \"\",\n            accountName: \"\",\n            role: undefined\n        };\n    }\n\n    public reset(): void {\n        this.setMultiState(this.initializeState());\n    }\n\n    private onAccountIDClearSelection = () => {\n        this.setMultiState({\n          accountID: \"\",\n          isAccountIDSelectOpen: false\n        });\n      };\n\n    private handlePrincipalChange = (value: string): void => {\n        this.setMultiState({\n            accountId: value,\n            isValid: this.checkValid(value, this.state.role)\n        })\n    };\n\n    private onAccountIDSelect = (_event: any, selection: string | SelectOptionObject, isPlaceholder: boolean | undefined) => {\n        if (isPlaceholder) {\n            this.onAccountIDClearSelection();\n        }  else {\n            const newState: any = {\n                accountId: selection,\n                accountName: this.getAccountName(selection as string),\n                isValid: this.checkValid(selection, this.state.role),\n                isAccountIDSelectOpen: false\n            };\n            this.setMultiState(newState);\n        }\n      };\n\n    private onAccountIDToggle = (isOpen: boolean) => {\n        this.setSingleState(\"isAccountIDSelectOpen\", isOpen);\n      };\n\n    private handleRoleChange = (isChecked: boolean, event: any): void => {\n        this.setMultiState({\n            isValid: this.checkValid(this.state.accountId, event.target.value),\n            role: event.target.value\n        })\n    };\n\n    private doGrantAccess = (): void => {\n        const principal: Principal = {\n            displayName: this.state.accountName,\n            id: this.state.accountId as string,\n            principalType: \"USER_ACCOUNT\"\n        };\n        this.props.onGrant(principal,\n            this.state.role as string,\n            this.props.roles?.find(role => role.principalId == this.state.accountId) !== undefined);\n        this.reset();\n    }\n\n    private checkValid(accountId: SelectOptionObject | string | undefined, role: string | undefined): boolean {\n        if (!accountId) {\n            return false;\n        }\n        if (!role) {\n            return false;\n        }\n        return true;\n    }\n\n    private getAccountName(accountId: string): string | undefined {\n        const principals: Principal[] | undefined = Services.getConfigService().principals();\n        if (principals) {\n            for (const principal of principals) {\n                if (principal.id === accountId) {\n                    return principal.displayName;\n                }\n            }\n        }\n        return undefined;\n    }\n}\n","/**\n * @license\n * Copyright 2020 JBoss Inc\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport React from \"react\";\nimport \"./roleList.css\";\nimport {\n    Button,\n    Modal\n} from '@patternfly/react-core';\nimport { TableComposable, Thead, Tbody, Tr, Th, Td } from '@patternfly/react-table';\nimport { PureComponent, PureComponentProps, PureComponentState } from \"../../../../components\";\nimport { RoleMapping, RoleTypes } from \"../../../../../models\";\nimport { RoleMappingsEmptyState } from '../empty';\n\n/**\n * Properties\n */\nexport interface RoleListProps extends PureComponentProps {\n    roles: RoleMapping[];\n    roleFilter: RoleMapping;\n    onRevoke: (principalId: string) => void;\n    onEditRoleMapping: (role: RoleMapping) => void;\n}\n\n/**\n * State\n */\n// tslint:disable-next-line:no-empty-interface\nexport interface RoleListState extends PureComponentState {\n    isRevokeModalOpen: boolean;\n    revokingPrincipalId: string;\n    currentRole: RoleMapping;\n}\n\n/**\n * Models the list of roles.\n */\nexport class RoleList extends PureComponent<RoleListProps, RoleListState> {\n\n    constructor(props: Readonly<RoleListProps>) {\n        super(props);\n    }\n\n    public render(): React.ReactElement {\n\n        const roleActions = (role: RoleMapping) => [\n            {\n                title: 'Edit',\n                onClick: () => { this.props.onEditRoleMapping(role)}\n            },\n            {\n                title: 'Revoke Access',\n                onClick: () => {this.onRevokeRoleMapping(role.principalId)}\n            }\n        ];\n\n        let filteredRoles = this.props.roles.sort((rm1, rm2) => {\n            return rm1.principalId.localeCompare(rm2.principalId);\n        }).filter((role: RoleMapping)=>{\n            if(this.props.roleFilter.principalId.length > 0) {\n                return role.principalId.includes(this.props.roleFilter.principalId);\n            }\n            return true;\n        }).filter((role: RoleMapping)=>{\n            if (this.props.roleFilter.role.length > 0) {\n                switch (role.role) {\n                    case RoleTypes.DEVELOPER:\n                        return \"Manager\".includes(this.props.roleFilter.role);\n                    case RoleTypes.ADMIN:\n                        return \"Admin\".includes(this.props.roleFilter.role);\n                    case RoleTypes.READ_ONLY:\n                        return \"Viewer\".includes(this.props.roleFilter.role);\n                }\n            }\n            return true;\n        });\n        return (\n            filteredRoles.length === 0 ?\n                <RoleMappingsEmptyState isFiltered={true}/> :\n            <React.Fragment>\n                <TableComposable className=\"role-list\">\n                    <Thead>\n                        <Tr>\n                            {/* <Th\n                            /> */}\n                            <Th>Account</Th>\n                            <Th>Role</Th>\n                        </Tr>\n                    </Thead>\n                    <Tbody>\n                        {filteredRoles.map((role, rowIndex) =>\n\n                            <Tr key={rowIndex}>\n                                {/* Disable for now until we want to support multi-select.\n                                <Td\n                                    key={`${rowIndex}_0`}\n                                    select={{\n                                        rowIndex,\n                                        onSelect: this.onSelect,\n                                        isSelected: false,\n                                    }}\n                                /> */}\n                                <Td>\n                                    <div className=\"principal-id\">{ role.principalId }</div>\n                                    <div className=\"principal-name\">{ role.principalName }</div>\n                                </Td>\n                                <Td>{this.roleName(role.role)}</Td>\n                                <Td className = \"role-list-action-column\"\n                                    key={`${rowIndex}_2`}\n                                    actions={{\n                                        items: roleActions(role)\n                                    }}\n                                />\n                            </Tr>\n                        )\n                        }\n                    </Tbody>\n                </TableComposable>\n                <Modal\n                    title=\"Revoke Access\"\n                    variant=\"small\"\n                    isOpen={this.state.isRevokeModalOpen}\n                    onClose={this.onRevokeModalClose}\n                    className=\"revoke-access-modal pf-m-redhat-font\"\n                    actions={[\n                        <Button key=\"revoke\" variant=\"primary\" data-testid=\"modal-btn-revoke\" onClick={this.doRevokeAccess}>Revoke</Button>,\n                        <Button key=\"cancel\" variant=\"link\" data-testid=\"modal-btn-cancel\" onClick={this.onRevokeModalClose}>Cancel</Button>\n                    ]}\n                >\n                    <p>Do you really want to revoke {this.state.revokingPrincipalId}'s access?</p>\n                </Modal>\n            </React.Fragment>\n        );\n    }\n\n    protected initializeState(): RoleListState {\n        return {\n            isRevokeModalOpen: false,\n            revokingPrincipalId: \"\",\n            currentRole: this.props.roles[0],\n        };\n    }\n\n    private roleName(role: string): string {\n        switch (role) {\n            case RoleTypes.DEVELOPER:\n                return \"Manager\";\n            case RoleTypes.ADMIN:\n                return \"Admin\";\n            case RoleTypes.READ_ONLY:\n                return \"Viewer\";\n        }\n        return role;\n    }\n\n    private onRevokeRoleMapping = (principalId: string) => {\n        this.setMultiState({\n            isRevokeModalOpen: true,\n            revokingPrincipalId: principalId\n        });\n    };\n\n    private onRevokeModalClose = (): void => {\n        this.setSingleState(\"isRevokeModalOpen\", false);\n    };\n\n    private doRevokeAccess = (): void => {\n        this.onRevokeModalClose();\n        this.props.onRevoke(this.state.revokingPrincipalId);\n    }\n\n}\n","/**\n * @license\n * Copyright 2020 JBoss Inc\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, {ReactNode} from \"react\";\nimport \"./roles.css\";\nimport {\n    Button,\n    ButtonVariant,\n    InputGroup,\n    PageSection,\n    PageSectionVariants,\n    Select,\n    SelectOption,\n    SelectOptionObject,\n    SelectVariant,\n    TextInput,\n    Toolbar,\n    ToolbarContent,\n    ToolbarFilter,\n    ToolbarGroup,\n    ToolbarItem\n} from '@patternfly/react-core';\nimport { SearchIcon } from \"@patternfly/react-icons\";\nimport {PageComponent, PageProps, PageState} from \"../basePage\";\nimport {RoleMapping} from \"../../../models\";\nimport {Principal, Services} from \"../../../services\";\nimport {GrantAccessModal, RoleList, RoleMappingsEmptyState} from \"./components\";\nimport {PleaseWaitModal, RootPageHeader} from \"../../components\";\n\n\n/**\n * Properties\n */\n// tslint:disable-next-line:no-empty-interface\nexport interface RolesPageProps extends PageProps {\n    principalSelect: any\n}\n\n/**\n * State\n */\n// tslint:disable-next-line:no-empty-interface\nexport interface RolesPageState extends PageState {\n    isCreateRoleMappingModalOpen: boolean;\n    isRoleMappingUpdate: boolean;\n    roles: RoleMapping[];\n    roleFilter: RoleMapping;\n    roleListFilterOpened: boolean;\n    roleFilterSelected: string;\n    roleFilterTextInputValue: string;\n    selectedRole: RoleMapping | undefined;\n    isPleaseWaitModalOpen: boolean;\n    pleaseWaitMessage: string;\n}\n\nconst roleFilterOptions = ['Account', 'Role'];\n/**\n * The global roles page.\n */\nexport class RolesPage extends PageComponent<RolesPageProps, RolesPageState> {\n\n    constructor(props: Readonly<RolesPageProps>) {\n        super(props);\n    }\n\n    public renderPage(): React.ReactElement {\n        return (\n            <React.Fragment>\n                <PageSection className=\"ps_roles-header\" variant={PageSectionVariants.light} padding={{ default : \"noPadding\" }}>\n                    <RootPageHeader tabKey={2} />\n                </PageSection>\n                <PageSection variant={PageSectionVariants.default} isFilled={true} className=\"ps_role-section\">\n                    {\n                        this.state.roles.length === 0 ?\n                            <RoleMappingsEmptyState onCreateRoleMapping={this.onCreateRoleMapping}/>\n                            :\n                            <>\n                                <Toolbar id=\"toolbar\" clearAllFilters={() => {\n                                    this.setSingleState(\"roleFilter\", {\n                                        principalId: \"\",\n                                        role: \"\"\n                                    });\n                                }}>\n                                    <ToolbarContent>\n                                        <ToolbarGroup>\n                                            <ToolbarItem className=\"ps_role-filter-select-toolbar-item\">\n                                                <Select\n                                                    variant={SelectVariant.single}\n                                                    aria-label=\"Filter On\"\n                                                    onToggle={this.onRoleFilterToggle}\n                                                    onSelect={this.onRoleFilterSelect}\n                                                    selections={this.state.roleFilterSelected}\n                                                    isOpen={this.state.roleListFilterOpened}\n                                                >\n                                                    {roleFilterOptions.map((option, index) => (\n                                                        <SelectOption key={index} value={option} />\n                                                    ))}\n                                                </Select>\n                                            </ToolbarItem>\n                                            <ToolbarItem>\n                                                <InputGroup>\n                                                    <TextInput value={this.state.roleFilterTextInputValue} name=\"roleFilterInput\" id=\"roleFilterInput\" type=\"search\" aria-label=\"role filter input\" onChange={this.onRoleFilterInputChange} />\n                                                    <Button variant={ButtonVariant.control} aria-label=\"search button for search input\" onClick={this.onRoleFilterApplyClick}>\n                                                        <SearchIcon />\n                                                    </Button>\n                                                </InputGroup>\n                                            </ToolbarItem>\n                                            <ToolbarItem>\n                                                <Button variant=\"primary\" data-testid=\"btn-grant-access\" onClick={this.onCreateRoleMapping}>Grant Access</Button>\n                                            </ToolbarItem>\n                                            <ToolbarFilter chips={this.state.roleFilter.principalId.length > 0 ? [this.state.roleFilter.principalId] : undefined}\n                                                deleteChip={() => {\n                                                    this.setSingleState(\"roleFilter\", {\n                                                        principalId: \"\",\n                                                        role: this.state.roleFilter.role\n                                                    });\n                                                }}\n                                                categoryName=\"Account\"> </ToolbarFilter>\n                                            <ToolbarFilter chips={this.state.roleFilter.role.length > 0 ? [this.state.roleFilter.role] : undefined}\n                                                deleteChip={() => {\n                                                    this.setSingleState(\"roleFilter\", {\n                                                        principalId: this.state.roleFilter.principalId,\n                                                        role: \"\"\n                                                    });\n                                                }}\n                                                categoryName=\"Role\"> </ToolbarFilter>\n\n                                        </ToolbarGroup>\n                                    </ToolbarContent>\n                                </Toolbar>\n                                <RoleList roles={this.state.roles} roleFilter={this.state.roleFilter} onRevoke={this.onRevokeRoleMapping} onEditRoleMapping={this.onEditRoleMapping}></RoleList>\n                            </>}\n                </PageSection>\n                <GrantAccessModal isOpen={this.state.isCreateRoleMappingModalOpen}\n                    isUpdateAccess={this.state.isRoleMappingUpdate}\n                    onClose={this.closeRoleMappingModal}\n                    onGrant={this.createRoleMapping}\n                    roles={this.state.isRoleMappingUpdate ? this.state.roles : null}\n                    defaultRole={this.state.selectedRole} />\n                <PleaseWaitModal message={this.state.pleaseWaitMessage}\n                                 isOpen={this.state.isPleaseWaitModalOpen} />\n            </React.Fragment>\n        );\n    }\n\n    protected initializePageState(): RolesPageState {\n        return {\n            isCreateRoleMappingModalOpen: false,\n            isPleaseWaitModalOpen: false,\n            isRoleMappingUpdate: false,\n            pleaseWaitMessage: \"\",\n            isLoading: true,\n            selectedRole: undefined,\n            roles: [],\n            roleFilter: { principalId: \"\", role: \"\" },\n            roleListFilterOpened: false,\n            roleFilterSelected: roleFilterOptions[0],\n            roleFilterTextInputValue: \"\"\n        };\n    }\n\n    // @ts-ignore\n    protected createLoaders(): Promise {\n        return Services.getAdminService().getRoleMappings().then(roles => {\n            this.setMultiState({\n                isLoading: false,\n                roles\n            });\n        });\n    }\n\n    private onRoleFilterToggle = (isExpanded: boolean): void => {\n        this.setSingleState(\"roleListFilterOpened\", isExpanded)\n    }\n\n    private onRoleFilterSelect = (_event: any, selection: string | SelectOptionObject, isPlaceholder: boolean | undefined) => {\n        this.setMultiState({\n            roleFilterSelected: selection,\n            roleListFilterOpened: false\n        });\n    };\n\n    private onRoleFilterInputChange = (value: string) => {\n        this.setSingleState(\"roleFilterTextInputValue\", value)\n    }\n    private onRoleFilterApplyClick = () => {\n        let newRoleMappingFilter: RoleMapping = {\n            principalId: this.state.roleFilterSelected == roleFilterOptions[0] ? this.state.roleFilterTextInputValue : this.state.roleFilter?.principalId,\n            role: this.state.roleFilterSelected == roleFilterOptions[1] ? this.state.roleFilterTextInputValue : this.state.roleFilter.role\n        }\n        this.setSingleState(\"roleFilter\", newRoleMappingFilter);\n    }\n    private onCreateRoleMapping = (): void => {\n        this.setSingleState(\"isCreateRoleMappingModalOpen\", true);\n    };\n\n    private closeRoleMappingModal = (): void => {\n        this.setMultiState({\n            selectedRole: undefined,\n            isRoleMappingUpdate: false,\n            isCreateRoleMappingModalOpen: false\n        });\n    };\n\n    private onEditRoleMapping = (role: RoleMapping) => {\n        this.setMultiState({\n            selectedRole: role,\n            isRoleMappingUpdate: true\n        })\n        this.onCreateRoleMapping();\n    }\n\n    private onUpdateRoleMapping = (principal: Principal, role: string): void => {\n        this.pleaseWait(true, \"Granting access, please wait...\");\n        Services.getAdminService().updateRoleMapping(principal.id, role).then((mapping) => {\n            const currentRoleMappings = this.state.roles;\n            currentRoleMappings.map((role, index) => {\n                if (role.principalId === mapping.principalId) {\n                    currentRoleMappings[index] = {\n                        ...mapping,\n                        principalName: principal.displayName as string\n                    };\n                }\n            });\n\n            this.pleaseWait(false, \"\");\n            this.setSingleState(\"roles\", [\n                ...currentRoleMappings\n            ]);\n        }).catch(e => this.handleServerError(e, \"Error updating access.\"));\n    };\n\n    private createRoleMapping = (principal: Principal, role: string, isUpdate: boolean): void => {\n        this.closeRoleMappingModal();\n        if (isUpdate) {\n            this.onUpdateRoleMapping(principal, role);\n        } else {\n            this.pleaseWait(true, \"Granting access, please wait...\");\n            Services.getAdminService().createRoleMapping(principal.id, role, principal.displayName as string).then((mapping) => {\n                this.pleaseWait(false, \"\");\n                this.setSingleState(\"roles\", [\n                    mapping, ...this.state.roles\n                ]);\n            }).catch(e => this.handleServerError(e, \"Error granting access.\"));\n        }\n    };\n\n    private onRevokeRoleMapping = (principalId: string): void => {\n        this.pleaseWait(true, `Revoking access for ${principalId}, please wait...`);\n        Services.getAdminService().deleteRoleMapping(principalId).then(() => {\n            this.pleaseWait(false, \"\");\n            this.removeMapping(principalId);\n        }).catch(e => this.handleServerError(e, \"Error revoking access.\"));\n    };\n\n    private pleaseWait = (isOpen: boolean, message: string): void => {\n        this.setMultiState({\n            isPleaseWaitModalOpen: isOpen,\n            pleaseWaitMessage: message\n        });\n    };\n\n    private removeMapping(principalId: string): void {\n        const newRoles: RoleMapping[] =\n            this.state.roles.filter(rm => {\n                return rm.principalId !== principalId;\n            });\n        this.setSingleState(\"roles\", newRoles);\n    }\n\n}\n"],"names":["props","render","EmptyState","variant","EmptyStateVariant","EmptyStateIcon","icon","PlusCircleIcon","Title","headingLevel","size","If","condition","isFiltered","EmptyStateBody","Button","onClick","this","onCreateRoleMapping","initializeState","onToggle","isOpen","setSingleState","clearSelection","reset","onSelect","_event","selection","isPlaceholder","setMultiState","id","onIdUpdate","initialOptions","Select","SelectVariant","typeAheadAriaLabel","onClear","selections","state","isInputValuePersisted","placeholderText","isCreatable","maxHeight","isGrouped","SelectGroup","label","key","filter","principal","principalType","map","index","SelectOption","value","description","displayName","Divider","onAccountIDClearSelection","accountID","isAccountIDSelectOpen","handlePrincipalChange","accountId","isValid","checkValid","role","onAccountIDSelect","newState","accountName","getAccountName","onAccountIDToggle","handleRoleChange","isChecked","event","target","doGrantAccess","onGrant","undefined","roles","find","principalId","componentDidUpdate","prevProps","defaultRole","principalName","principals","Services","Modal","title","onClose","className","actions","isDisabled","isUpdateAccess","Form","serviceRegistryInstance","DescriptionList","DescriptionListGroup","DescriptionListTerm","DescriptionListDescription","FormGroup","labelIcon","Tooltip","position","content","OutlinedQuestionCircleIcon","isRequired","fieldId","SelectPrincipalAccount","name","option","TextInput","type","onChange","Radio","RoleTypes","onRevokeRoleMapping","isRevokeModalOpen","revokingPrincipalId","onRevokeModalClose","doRevokeAccess","onRevoke","roleActions","onEditRoleMapping","filteredRoles","sort","rm1","rm2","localeCompare","roleFilter","length","includes","TableComposable","Thead","Tr","Th","Tbody","rowIndex","Td","roleName","items","currentRole","roleFilterOptions","onRoleFilterToggle","isExpanded","onRoleFilterSelect","roleFilterSelected","roleListFilterOpened","onRoleFilterInputChange","onRoleFilterApplyClick","newRoleMappingFilter","roleFilterTextInputValue","closeRoleMappingModal","selectedRole","isRoleMappingUpdate","isCreateRoleMappingModalOpen","onUpdateRoleMapping","pleaseWait","updateRoleMapping","then","mapping","currentRoleMappings","catch","e","handleServerError","createRoleMapping","isUpdate","deleteRoleMapping","removeMapping","message","isPleaseWaitModalOpen","pleaseWaitMessage","renderPage","PageSection","PageSectionVariants","padding","default","tabKey","isFilled","Toolbar","clearAllFilters","ToolbarContent","ToolbarGroup","ToolbarItem","InputGroup","ButtonVariant","SearchIcon","ToolbarFilter","chips","deleteChip","categoryName","initializePageState","isLoading","createLoaders","getRoleMappings","newRoles","rm"],"sourceRoot":""}