/*! For license information please see 60.bundle.154ff5932bca7d7b6d88.js.LICENSE.txt */
"use strict";(self.webpackChunk_apicurio_registry_ui=self.webpackChunk_apicurio_registry_ui||[]).push([[60],{19595:(e,t,n)=>{n.d(t,{g:()=>u});var i,r=n(48121),a=n.n(r),o=n(95995),l=n(93568),c=n(60553),s=n(24754),p=(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},i(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),u=function(e){function t(t){return e.call(this,t)||this}return p(t,e),t.prototype.render=function(){var e=this;return a().createElement(o.EmptyState,{variant:o.EmptyStateVariant.full},a().createElement(o.EmptyStateIcon,{icon:l.PlusCircleIcon}),a().createElement(o.Title,{headingLevel:"h5",size:"lg"},"No Role Mappings"),a().createElement(s.If,{condition:function(){return!0===e.props.isFiltered}},a().createElement(o.EmptyStateBody,null,"No role mappings match your filter settings.  Change your filter or perhaps create a new role mapping.")),a().createElement(s.If,{condition:function(){return!e.props.isFiltered}},a().createElement(o.EmptyStateBody,null,'There are currently no role mappings configured for the registry.  Click the "Grant Access" button above to grant access to a user.'),a().createElement(o.Button,{variant:"primary","data-testid":"btn-grant-access",onClick:this.props.onCreateRoleMapping},"Grant Access")))},t.prototype.initializeState=function(){return{}},t}(c.Vx)},38166:(e,t,n)=>{n.d(t,{C:()=>h});var i,r=n(48121),a=n.n(r),o=n(95995),l=n(46768),c=n(60553),s=n(19162),p=n(93568),u=(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},i(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),d=function(e){function t(t){var n=e.call(this,t)||this;return n.onToggle=function(e){n.setSingleState("isOpen",e)},n.clearSelection=function(){n.reset()},n.onSelect=function(e,t,i){i?n.clearSelection():n.setMultiState({id:t,isOpen:!1}),n.props.onIdUpdate(t)},n}return u(t,e),t.prototype.initializeState=function(){return{id:"",isOpen:!1}},t.prototype.reset=function(){this.setMultiState(this.initializeState())},t.prototype.render=function(){var e=this.props,t=e.initialOptions,n=e.id;return a().createElement(o.Select,{variant:o.SelectVariant.typeahead,typeAheadAriaLabel:"Select an account",onToggle:this.onToggle,onSelect:this.onSelect,onClear:this.clearSelection,selections:n,isOpen:this.state.isOpen,isInputValuePersisted:!0,placeholderText:"Select an account",isCreatable:!1,maxHeight:400,isGrouped:!0},[a().createElement(o.SelectGroup,{label:"Service accounts",key:"service_accounts_group"},t.filter((function(e){return"SERVICE_ACCOUNT"===e.principalType})).map((function(e,t){return a().createElement(o.SelectOption,{key:t,value:e.id,description:e.displayName},e.id)}))),a().createElement(o.Divider,{key:"divider"}),a().createElement(o.SelectGroup,{label:"User accounts",key:"user_accounts_group"},t.filter((function(e){return"USER_ACCOUNT"===e.principalType})).map((function(e,t){return a().createElement(o.SelectOption,{key:t,value:e.id,description:e.displayName},e.id)})))])},t}(c.Vx),g=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),h=function(e){function t(t){var n=e.call(this,t)||this;return n.onAccountIDClearSelection=function(){n.setMultiState({accountID:"",isAccountIDSelectOpen:!1})},n.handlePrincipalChange=function(e){n.setMultiState({accountId:e,isValid:n.checkValid(e,n.state.role)})},n.onAccountIDSelect=function(e,t,i){if(i)n.onAccountIDClearSelection();else{var r={accountId:t,accountName:n.getAccountName(t),isValid:n.checkValid(t,n.state.role),isAccountIDSelectOpen:!1};n.setMultiState(r)}},n.onAccountIDToggle=function(e){n.setSingleState("isAccountIDSelectOpen",e)},n.handleRoleChange=function(e,t){n.setMultiState({isValid:n.checkValid(n.state.accountId,t.target.value),role:t.target.value})},n.doGrantAccess=function(){var e,t={displayName:n.state.accountName,id:n.state.accountId,principalType:"USER_ACCOUNT"};n.props.onGrant(t,n.state.role,void 0!==(null===(e=n.props.roles)||void 0===e?void 0:e.find((function(e){return e.principalId==n.state.accountId})))),n.reset()},n}return g(t,e),t.prototype.componentDidUpdate=function(e){this.props.defaultRole!==e.defaultRole&&(this.props.defaultRole?this.setMultiState({accountId:this.props.defaultRole.principalId,accountName:this.props.defaultRole.principalName,role:this.props.defaultRole.role}):this.setMultiState({accountId:"",accountName:"",role:void 0}))},t.prototype.render=function(){var e,t=this,n=l.Services.getConfigService().principals();return a().createElement(o.Modal,{title:"Manage Permissions",description:"Manage access to resources in this Service Registry instance by assigning permissions to an account.",variant:"medium",isOpen:this.props.isOpen,onClose:this.props.onClose,className:"grant-access-modal pf-m-redhat-font",actions:[a().createElement(o.Button,{key:"grant",variant:"primary","data-testid":"modal-btn-grant",onClick:this.doGrantAccess,isDisabled:!this.state.isValid},this.props.isUpdateAccess?"Update":"Create"),a().createElement(o.Button,{key:"cancel",variant:"link","data-testid":"modal-btn-cancel",onClick:this.props.onClose},"Cancel")]},a().createElement(o.Form,null,void 0!==this.props.serviceRegistryInstance?a().createElement(o.DescriptionList,null,a().createElement(o.DescriptionListGroup,null,a().createElement(o.DescriptionListTerm,null,"Service Registry instance"),a().createElement(o.DescriptionListDescription,null,this.props.serviceRegistryInstance))):void 0,a().createElement(o.FormGroup,{label:"Account ID",labelIcon:a().createElement(o.Tooltip,{position:"top",content:a().createElement("div",null,"A service account enables your application or tool to connect securely to your resources. A user account enables users in your organization to access resources.")},a().createElement(p.OutlinedQuestionCircleIcon,null)),isRequired:!0,fieldId:"grant-access-account-id"},n?a().createElement(d,{id:this.state.accountId,onIdUpdate:function(e){t.onAccountIDSelect(null,e,!1)},initialOptions:n||[]}):null!==this.props.roles?a().createElement(o.Select,{id:"grant-access-principal",name:"grant-access-principal",variant:o.SelectVariant.typeahead,typeAheadAriaLabel:"Select an account ID",onToggle:this.onAccountIDToggle,onSelect:this.onAccountIDSelect,onClear:this.onAccountIDClearSelection,selections:this.state.accountId,isOpen:this.state.isAccountIDSelectOpen,isInputValuePersisted:!0,placeholderText:this.props.isUpdateAccess?null===(e=this.props.defaultRole)||void 0===e?void 0:e.principalId:"Select an account ID",maxHeight:"100px",isDisabled:this.props.isUpdateAccess},this.props.roles.map((function(e,t){return a().createElement(o.SelectOption,{key:t,value:e.principalId})}))):a().createElement(o.TextInput,{isRequired:!0,type:"text",id:"grant-access-principal",name:"grant-access-principal","aria-describedby":"grant-access-principal-helper",onChange:this.handlePrincipalChange})),a().createElement(o.FormGroup,{label:"Role",isRequired:!0,fieldId:"grant-access-role"},a().createElement(o.Radio,{id:"grant-access-role-admin",className:"grant-access-radio-button",name:"grant-access-role",label:"Administrator",description:"Give roles to other principals on this Service Registry instance, configure global rules, and access data import and export features.",value:s.RoleTypes.ADMIN,onChange:this.handleRoleChange,isChecked:this.state.role==s.RoleTypes.ADMIN}),a().createElement(o.Radio,{id:"grant-access-role-manager",className:"grant-access-radio-button",name:"grant-access-role",label:"Manager",description:"Read and write artifacts on this Service Registry instance.",value:s.RoleTypes.DEVELOPER,onChange:this.handleRoleChange,isChecked:this.state.role==s.RoleTypes.DEVELOPER}),a().createElement(o.Radio,{id:"grant-access-role-viewer",className:"grant-access-radio-button",name:"grant-access-role",label:"Viewer",description:"Read artifacts on this Service Registry instance.",value:s.RoleTypes.READ_ONLY,onChange:this.handleRoleChange,isChecked:this.state.role==s.RoleTypes.READ_ONLY}))))},t.prototype.initializeState=function(){return{isAccountIDSelectOpen:!1,isValid:!1,accountId:"",accountName:"",role:void 0}},t.prototype.reset=function(){this.setMultiState(this.initializeState())},t.prototype.checkValid=function(e,t){return!!e&&!!t},t.prototype.getAccountName=function(e){var t=l.Services.getConfigService().principals();if(t)for(var n=0,i=t;n<i.length;n++){var r=i[n];if(r.id===e)return r.displayName}},t}(c.Vx)},41016:(e,t,n)=>{n.d(t,{s:()=>d});var i,r=n(48121),a=n.n(r),o=n(95995),l=n(34168),c=n(60553),s=n(19162),p=n(19595),u=(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},i(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),d=function(e){function t(t){var n=e.call(this,t)||this;return n.onRevokeRoleMapping=function(e){n.setMultiState({isRevokeModalOpen:!0,revokingPrincipalId:e})},n.onRevokeModalClose=function(){n.setSingleState("isRevokeModalOpen",!1)},n.doRevokeAccess=function(){n.onRevokeModalClose(),n.props.onRevoke(n.state.revokingPrincipalId)},n}return u(t,e),t.prototype.render=function(){var e=this,t=function(t){return[{title:"Edit",onClick:function(){e.props.onEditRoleMapping(t)}},{title:"Revoke Access",onClick:function(){e.onRevokeRoleMapping(t.principalId)}}]},n=this.props.roles.sort((function(e,t){return e.principalId.localeCompare(t.principalId)})).filter((function(t){return!(e.props.roleFilter.principalId.length>0)||t.principalId.includes(e.props.roleFilter.principalId)})).filter((function(t){if(e.props.roleFilter.role.length>0)switch(t.role){case s.RoleTypes.DEVELOPER:return"Manager".includes(e.props.roleFilter.role);case s.RoleTypes.ADMIN:return"Admin".includes(e.props.roleFilter.role);case s.RoleTypes.READ_ONLY:return"Viewer".includes(e.props.roleFilter.role)}return!0}));return 0===n.length?a().createElement(p.g,{isFiltered:!0}):a().createElement(a().Fragment,null,a().createElement(l.TableComposable,{className:"role-list"},a().createElement(l.Thead,null,a().createElement(l.Tr,null,a().createElement(l.Th,null,"Account"),a().createElement(l.Th,null,"Role"))),a().createElement(l.Tbody,null,n.map((function(n,i){return a().createElement(l.Tr,{key:i},a().createElement(l.Td,null,a().createElement("div",{className:"principal-id"},n.principalId),a().createElement("div",{className:"principal-name"},n.principalName)),a().createElement(l.Td,null,e.roleName(n.role)),a().createElement(l.Td,{className:"role-list-action-column",key:i+"_2",actions:{items:t(n)}}))})))),a().createElement(o.Modal,{title:"Revoke Access",variant:"small",isOpen:this.state.isRevokeModalOpen,onClose:this.onRevokeModalClose,className:"revoke-access-modal pf-m-redhat-font",actions:[a().createElement(o.Button,{key:"revoke",variant:"primary","data-testid":"modal-btn-revoke",onClick:this.doRevokeAccess},"Revoke"),a().createElement(o.Button,{key:"cancel",variant:"link","data-testid":"modal-btn-cancel",onClick:this.onRevokeModalClose},"Cancel")]},a().createElement("p",null,"Do you really want to revoke ",this.state.revokingPrincipalId,"'s access?")))},t.prototype.initializeState=function(){return{isRevokeModalOpen:!1,revokingPrincipalId:"",currentRole:this.props.roles[0]}},t.prototype.roleName=function(e){switch(e){case s.RoleTypes.DEVELOPER:return"Manager";case s.RoleTypes.ADMIN:return"Admin";case s.RoleTypes.READ_ONLY:return"Viewer"}return e},t}(c.Vx)},54896:(e,t,n)=>{n.d(t,{s:()=>f});var i,r=n(48121),a=n.n(r),o=n(95995),l=n(93568),c=n(26619),s=n(46768),p=n(11940),u=n(60553),d=(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},i(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),g=function(){return g=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},g.apply(this,arguments)},h=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),r=0;for(t=0;t<n;t++)for(var a=arguments[t],o=0,l=a.length;o<l;o++,r++)i[r]=a[o];return i},m=["Account","Role"],f=function(e){function t(t){var n=e.call(this,t)||this;return n.onRoleFilterToggle=function(e){n.setSingleState("roleListFilterOpened",e)},n.onRoleFilterSelect=function(e,t,i){n.setMultiState({roleFilterSelected:t,roleListFilterOpened:!1})},n.onRoleFilterInputChange=function(e){n.setSingleState("roleFilterTextInputValue",e)},n.onRoleFilterApplyClick=function(){var e,t={principalId:n.state.roleFilterSelected==m[0]?n.state.roleFilterTextInputValue:null===(e=n.state.roleFilter)||void 0===e?void 0:e.principalId,role:n.state.roleFilterSelected==m[1]?n.state.roleFilterTextInputValue:n.state.roleFilter.role};n.setSingleState("roleFilter",t)},n.onCreateRoleMapping=function(){n.setSingleState("isCreateRoleMappingModalOpen",!0)},n.closeRoleMappingModal=function(){n.setMultiState({selectedRole:void 0,isRoleMappingUpdate:!1,isCreateRoleMappingModalOpen:!1})},n.onEditRoleMapping=function(e){n.setMultiState({selectedRole:e,isRoleMappingUpdate:!0}),n.onCreateRoleMapping()},n.onUpdateRoleMapping=function(e,t){n.pleaseWait(!0,"Granting access, please wait..."),s.Services.getAdminService().updateRoleMapping(e.id,t).then((function(t){var i=n.state.roles;i.map((function(n,r){n.principalId===t.principalId&&(i[r]=g(g({},t),{principalName:e.displayName}))})),n.pleaseWait(!1,""),n.setSingleState("roles",h(i))})).catch((function(e){return n.handleServerError(e,"Error updating access.")}))},n.createRoleMapping=function(e,t,i){n.closeRoleMappingModal(),i?n.onUpdateRoleMapping(e,t):(n.pleaseWait(!0,"Granting access, please wait..."),s.Services.getAdminService().createRoleMapping(e.id,t,e.displayName).then((function(e){n.pleaseWait(!1,""),n.setSingleState("roles",h([e],n.state.roles))})).catch((function(e){return n.handleServerError(e,"Error granting access.")})))},n.onRevokeRoleMapping=function(e){n.pleaseWait(!0,"Revoking access for "+e+", please wait..."),s.Services.getAdminService().deleteRoleMapping(e).then((function(){n.pleaseWait(!1,""),n.removeMapping(e)})).catch((function(e){return n.handleServerError(e,"Error revoking access.")}))},n.pleaseWait=function(e,t){n.setMultiState({isPleaseWaitModalOpen:e,pleaseWaitMessage:t})},n}return d(t,e),t.prototype.renderPage=function(){var e=this;return a().createElement(a().Fragment,null,a().createElement(o.PageSection,{className:"ps_roles-header",variant:o.PageSectionVariants.light,padding:{default:"noPadding"}},a().createElement(u.N4,{tabKey:2})),a().createElement(o.PageSection,{variant:o.PageSectionVariants.default,isFilled:!0,className:"ps_role-section"},0===this.state.roles.length?a().createElement(p.gx,{onCreateRoleMapping:this.onCreateRoleMapping}):a().createElement(a().Fragment,null,a().createElement(o.Toolbar,{id:"toolbar",clearAllFilters:function(){e.setSingleState("roleFilter",{principalId:"",role:""})}},a().createElement(o.ToolbarContent,null,a().createElement(o.ToolbarGroup,null,a().createElement(o.ToolbarItem,{className:"ps_role-filter-select-toolbar-item"},a().createElement(o.Select,{variant:o.SelectVariant.single,"aria-label":"Filter On",onToggle:this.onRoleFilterToggle,onSelect:this.onRoleFilterSelect,selections:this.state.roleFilterSelected,isOpen:this.state.roleListFilterOpened},m.map((function(e,t){return a().createElement(o.SelectOption,{key:t,value:e})})))),a().createElement(o.ToolbarItem,null,a().createElement(o.InputGroup,null,a().createElement(o.TextInput,{value:this.state.roleFilterTextInputValue,name:"roleFilterInput",id:"roleFilterInput",type:"search","aria-label":"role filter input",onChange:this.onRoleFilterInputChange}),a().createElement(o.Button,{variant:o.ButtonVariant.control,"aria-label":"search button for search input",onClick:this.onRoleFilterApplyClick},a().createElement(l.SearchIcon,null)))),a().createElement(o.ToolbarItem,null,a().createElement(o.Button,{variant:"primary","data-testid":"btn-grant-access",onClick:this.onCreateRoleMapping},"Grant Access")),a().createElement(o.ToolbarFilter,{chips:this.state.roleFilter.principalId.length>0?[this.state.roleFilter.principalId]:void 0,deleteChip:function(){e.setSingleState("roleFilter",{principalId:"",role:e.state.roleFilter.role})},categoryName:"Account"}," "),a().createElement(o.ToolbarFilter,{chips:this.state.roleFilter.role.length>0?[this.state.roleFilter.role]:void 0,deleteChip:function(){e.setSingleState("roleFilter",{principalId:e.state.roleFilter.principalId,role:""})},categoryName:"Role"}," ")))),a().createElement(p.st,{roles:this.state.roles,roleFilter:this.state.roleFilter,onRevoke:this.onRevokeRoleMapping,onEditRoleMapping:this.onEditRoleMapping}))),a().createElement(p.C0,{isOpen:this.state.isCreateRoleMappingModalOpen,isUpdateAccess:this.state.isRoleMappingUpdate,onClose:this.closeRoleMappingModal,onGrant:this.createRoleMapping,roles:this.state.isRoleMappingUpdate?this.state.roles:null,defaultRole:this.state.selectedRole}),a().createElement(u.jb,{message:this.state.pleaseWaitMessage,isOpen:this.state.isPleaseWaitModalOpen}))},t.prototype.initializePageState=function(){return{isCreateRoleMappingModalOpen:!1,isPleaseWaitModalOpen:!1,isRoleMappingUpdate:!1,pleaseWaitMessage:"",isLoading:!0,selectedRole:void 0,roles:[],roleFilter:{principalId:"",role:""},roleListFilterOpened:!1,roleFilterSelected:m[0],roleFilterTextInputValue:""}},t.prototype.createLoaders=function(){var e=this;return s.Services.getAdminService().getRoleMappings().then((function(t){e.setMultiState({isLoading:!1,roles:t})}))},t.prototype.removeMapping=function(e){var t=this.state.roles.filter((function(t){return t.principalId!==e}));this.setSingleState("roles",t)},t}(c.I)}}]);
//# sourceMappingURL=60.bundle.154ff5932bca7d7b6d88.js.map