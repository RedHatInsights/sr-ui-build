/*! For license information please see 7569.d709160e.js.LICENSE.txt */
"use strict";(self.webpackChunk_apicurio_registry_ui=self.webpackChunk_apicurio_registry_ui||[]).push([[7569],{89872:(e,t,l)=>{l.d(t,{C0:()=>r.C,gx:()=>n.g,jx:()=>r.j,st:()=>i.s});var n=l(55194),i=l(51680),r=l(95101)},24499:(e,t,l)=>{l.r(t),l.d(t,{default:()=>a});l(77685);var n,i=l(58306),r=l(2331),o=(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var l in t)t.hasOwnProperty(l)&&(e[l]=t[l])},n(e,t)},function(e,t){function l(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(l.prototype=t.prototype,new l)});const a=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.prototype.postConstruct=function(){r.m.updateConfiguration(this.props),e.prototype.postConstruct.call(this)},t}(i.s)},58306:(e,t,l)=>{l.d(t,{s:()=>F});var n,i=l(93264),r=l.n(i),o=(l(77685),l(99922)),a=l(67646),p=l(37799),s=l(99926),c=l(89872),u=l(79824),d=l(8556),g=(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var l in t)t.hasOwnProperty(l)&&(e[l]=t[l])},n(e,t)},function(e,t){function l(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(l.prototype=t.prototype,new l)}),h=function(){return h=Object.assign||function(e){for(var t,l=1,n=arguments.length;l<n;l++)for(var i in t=arguments[l])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},h.apply(this,arguments)},f=function(){for(var e=0,t=0,l=arguments.length;t<l;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<l;t++)for(var r=arguments[t],o=0,a=r.length;o<a;o++,i++)n[i]=r[o];return n},S=["Account","Role"],F=function(e){function t(t){var l=e.call(this,t)||this;return l.onRoleFilterToggle=function(e){l.setSingleState("roleListFilterOpened",e)},l.onRoleFilterSelectToggle=function(e){l.setSingleState("roleFilterSelectInputOpened",e)},l.onRoleFilterSelect=function(e,t,n){l.setMultiState({roleFilterSelected:t,roleListFilterOpened:!1})},l.onRoleFilterInputChange=function(e){l.setSingleState("roleFilterTextInputValue",e)},l.onRoleFilterTextInputKeydown=function(e){"Enter"===e.key&&l.onRoleFilterApplyClick()},l.onRoleFilterApplyClick=function(){var e,t,n={principalId:l.state.roleFilterSelected==S[0]?l.state.roleFilterTextInputValue:null===(e=l.state.roleFilter)||void 0===e?void 0:e.principalId,role:l.state.roleFilterSelected==S[1]?l.state.roleFilterSelectInputValue:l.state.roleFilter.role,principalName:l.state.roleFilterSelected==S[0]?l.state.roleFilterTextInputValue:null===(t=l.state.roleFilter)||void 0===t?void 0:t.principalId};l.setMultiState({roleFilter:n,roleFilterTextInputValue:""})},l.onCreateRoleMapping=function(){l.setSingleState("isCreateRoleMappingModalOpen",!0)},l.isAccountFilterSelected=function(){return l.state.roleFilterSelected==S[0]},l.isRoleFilterSelected=function(){return l.state.roleFilterSelected==S[1]},l.onRoleFilterSelectChange=function(e,t,n){l.setMultiState({roleFilterSelectInputValue:t,roleFilterSelectInputOpened:!1},(function(){return l.onRoleFilterApplyClick()}))},l.closeRoleMappingModal=function(){l.setMultiState({selectedRole:void 0,isRoleMappingUpdate:!1,isCreateRoleMappingModalOpen:!1})},l.onEditRoleMapping=function(e){l.setMultiState({selectedRole:e,isRoleMappingUpdate:!0}),l.onCreateRoleMapping()},l.updateRoleMapping=function(e,t){l.pleaseWait(!0,"Granting access, please wait..."),s.K9.getAdminService().updateRoleMapping(e.id,t).then((function(t){var n=l.state.roles;n.forEach((function(l,i){l.principalId===t.principalId&&(n[i]=h(h({},t),{principalName:e.displayName}))})),l.pleaseWait(!1,""),l.setSingleState("roles",f(n))})).catch((function(e){return l.handleServerError(e,"Error updating access.")}))},l.createRoleMapping=function(e,t,n){l.closeRoleMappingModal(),n?l.updateRoleMapping(e,t):(l.pleaseWait(!0,"Granting access, please wait..."),s.K9.getAdminService().createRoleMapping(e.id,t,e.displayName).then((function(e){l.pleaseWait(!1,""),l.setSingleState("roles",f([e],l.state.roles))})).catch((function(n){409===(null==n?void 0:n.error_code)?l.updateRoleMapping(e,t):l.handleServerError(n,"Error granting access.")})))},l.onRevokeRoleMapping=function(e){l.pleaseWait(!0,"Revoking access for "+e+", please wait..."),s.K9.getAdminService().deleteRoleMapping(e).then((function(){l.pleaseWait(!1,""),l.removeMapping(e)})).catch((function(e){return l.handleServerError(e,"Error revoking access.")}))},l.pleaseWait=function(e,t){l.setMultiState({isPleaseWaitModalOpen:e,pleaseWaitMessage:t})},l}return g(t,e),t.prototype.renderPage=function(){var e=this;return r().createElement(r().Fragment,null,r().createElement(o.PageSection,{className:"ps_roles-header",variant:o.PageSectionVariants.light,padding:{default:"noPadding"}},r().createElement(u.N4,{tabKey:2})),r().createElement(o.PageSection,{variant:o.PageSectionVariants.default,isFilled:!0,className:"ps_role-section"},0===this.state.roles.length?r().createElement(c.gx,{onCreateRoleMapping:this.onCreateRoleMapping}):r().createElement(r().Fragment,null,r().createElement(o.Toolbar,{id:"toolbar",clearAllFilters:function(){e.setSingleState("roleFilter",{principalId:"",role:"",principalName:""})}},r().createElement(o.ToolbarContent,null,r().createElement(o.ToolbarGroup,null,r().createElement(o.ToolbarItem,{className:"ps_role-filter-select-toolbar-item"},r().createElement(o.Select,{variant:o.SelectVariant.single,"aria-label":"Filter On",onToggle:this.onRoleFilterToggle,onSelect:this.onRoleFilterSelect,selections:this.state.roleFilterSelected,isOpen:this.state.roleListFilterOpened},S.map((function(e,t){return r().createElement(o.SelectOption,{key:t,value:e})})))),r().createElement(o.ToolbarItem,null,r().createElement(o.InputGroup,null,this.isRoleFilterSelected()?r().createElement(o.Select,{variant:o.SelectVariant.single,"aria-label":"Role",onToggle:this.onRoleFilterSelectToggle,onSelect:this.onRoleFilterSelectChange,isOpen:this.state.roleFilterSelectInputOpened,placeholderText:"Filter by role"},r().createElement(o.SelectOption,{key:1,value:"Administrator"}),r().createElement(o.SelectOption,{key:2,value:"Manager"}),r().createElement(o.SelectOption,{key:3,value:"Viewer"})):r().createElement(o.TextInput,{value:this.state.roleFilterTextInputValue,placeholder:"Filter by account",name:"roleFilterInput",id:"roleFilterInput",type:"search","aria-label":"role filter input",onKeyDown:this.onRoleFilterTextInputKeydown,onChange:this.onRoleFilterInputChange}),r().createElement(d.If,{condition:this.isAccountFilterSelected},r().createElement(o.Button,{variant:o.ButtonVariant.control,"aria-label":"search button for search input",onClick:this.onRoleFilterApplyClick},r().createElement(a.SearchIcon,null))))),r().createElement(o.ToolbarItem,null,r().createElement(o.Button,{variant:"primary","data-testid":"btn-grant-access",onClick:this.onCreateRoleMapping},"Grant access")),r().createElement(o.ToolbarFilter,{chips:this.state.roleFilter.principalId.length>0?[this.state.roleFilter.principalId]:void 0,deleteChip:function(){e.setSingleState("roleFilter",{principalId:"",role:e.state.roleFilter.role,principalName:""})},categoryName:"Account"}," "),r().createElement(o.ToolbarFilter,{chips:this.state.roleFilter.role.length>0?[this.state.roleFilter.role]:void 0,deleteChip:function(){e.setSingleState("roleFilter",{principalId:e.state.roleFilter.principalId,role:"",principalName:e.state.roleFilter.principalName})},categoryName:"Role"}," ")))),r().createElement(c.st,{roles:this.state.roles,roleFilter:this.state.roleFilter,onRevoke:this.onRevokeRoleMapping,onEditRoleMapping:this.onEditRoleMapping}))),r().createElement(c.C0,{isOpen:this.state.isCreateRoleMappingModalOpen,isUpdateAccess:this.state.isRoleMappingUpdate,onClose:this.closeRoleMappingModal,onGrant:this.createRoleMapping,roles:this.state.isRoleMappingUpdate?this.state.roles:null,defaultRole:this.state.selectedRole}),r().createElement(u.jb,{message:this.state.pleaseWaitMessage,isOpen:this.state.isPleaseWaitModalOpen}))},t.prototype.initializePageState=function(){return{isCreateRoleMappingModalOpen:!1,isPleaseWaitModalOpen:!1,isRoleMappingUpdate:!1,pleaseWaitMessage:"",selectedRole:void 0,roles:[],roleFilter:{principalId:"",role:"",principalName:""},roleListFilterOpened:!1,roleFilterSelected:S[0],roleFilterTextInputValue:"",roleFilterSelectInputValue:"",roleFilterSelectInputOpened:!1}},t.prototype.createLoaders=function(){var e=this;return s.K9.getAdminService().getRoleMappings().then((function(t){e.setMultiState({isLoading:!1,roles:t})}))},t.prototype.removeMapping=function(e){var t=this.state.roles.filter((function(t){return t.principalId!==e}));this.setSingleState("roles",t)},t}(p.I)}}]);
//# sourceMappingURL=7569.d709160e.js.map